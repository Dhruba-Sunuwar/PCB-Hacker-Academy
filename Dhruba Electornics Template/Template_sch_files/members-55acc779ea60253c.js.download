(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4228],{42808:function(e,t,r){"use strict";var n=r(50029),i=r(59499),a=r(64687),s=r.n(a),o=r(53531),c=r(5095),u=r(85893);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}t.Z=function(e){var t;function r(t){return(0,u.jsx)(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},t))}return r.getRenderData=e.getRenderData,r.initPage=(t=(0,n.Z)(s().mark(function t(r){var n,i,a,u,l,p,d,m,b,f;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.ctx,i=r.props,a=r.apiClient,u=i.self,l=i.currentGroup,p=n.query,d=(0,c.aK)(p),m=(0,c.VO)(p),b=(0,c.kG)(p),(0,o.Wr)({member:null==u?void 0:u.member,group:l})){t.next=10;break}return f=(0,c.jQ)({invite:d,group:l,ref:b,pending:m}).as,t.abrupt("return",{settings:{redirect:{destination:f,permanent:!1}}});case 10:if(!e.initPage){t.next=16;break}return t.next=13,e.initPage({ctx:n,props:i,apiClient:a});case 13:t.t0=t.sent,t.next=17;break;case 16:t.t0=i;case 17:return t.abrupt("return",t.t0);case 18:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)}),r}},28071:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return $},default:function(){return H}});var n,i,a=r(59499),s=r(90116),o=r(50029),c=r(64687),u=r.n(c),l=r(81737),p=r(62278),d=r(70842),m=r(8024),b=r(59607),f=r(85064),v=r(67294),y=r(73793),g=r(11163),h=r(27849),x=r(53531),k=r(29610),O=r(91194),w=r(99802),P=r(5095),j=r(95419),I=r(42808),M=r(31593),C=r(30697),T=[{key:"status",label:"Status",multiple:!0,columns:2,width:167,choices:[{key:"admins",label:"Admins"},{key:"online",label:"Online"}]},{key:"price",label:"Price",adminOnly:!0,multiple:!0,columns:2,width:167,choices:[]},{key:"courseIds",label:"Courses",adminOnly:!0,multiple:!0,columns:1,width:266,choices:[]},{key:"sortType",label:"Sort",width:181,labelPrefix:"Sort:",choices:[{key:"-memberapprovedat",label:"Newest"},{key:"-memberlastoffline",label:"Last active"},{key:"-memberpoints",label:"Most points"}]}],D=r(50378),_=r(20668),N=r(14251),S=(0,D.iv)(["padding:0px 10px;margin-bottom:16px;> div{gap:8px;}"]),Z=D.ZP.div.withConfig({displayName:"styled__GroupMembersHeader",componentId:"sc-cx05x3-0"})(["display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;> div{display:flex;gap:8px;}> label{","}",""],_.c.t7,function(e){return e.theme.isMobile&&S}),A=(0,D.iv)(["padding:0px 13px;"]),E=D.ZP.div.withConfig({displayName:"styled__NoMembersWrapper",componentId:"sc-cx05x3-1"})([""," ",""],_.c.t7,function(e){return e.theme.isMobile&&A}),F=D.ZP.div.withConfig({displayName:"styled__CsvLoadingWrapper",componentId:"sc-cx05x3-2"})(["height:40px;width:92.39px;display:flex;justify-content:center;align-items:center;background:",";border-radius:25px;color:",";"],N.O9.n3,N.O9.n5),q=(0,D.iv)(["> div{height:14px !important;width:14px !important;}"]),R=(0,D.ZP)(b.z).withConfig({displayName:"styled__InviteButton",componentId:"sc-cx05x3-3"})(["height:40px;background-color:",";color:",";"," ",""],N.O9.p3,N.O9.fgPrimary,_.c.t8,function(e){return e.theme.isMobile&&q}),G=r(30899),B=r(85893);function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach(function(t){(0,a.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var z=function(e){var t=document.createElement("a");t.href=e,t.download=!0,t.click()},K=function(e){var t=e.page,r=e.price,n=e.total,i=e.users,a=e.online,c=e.levels,k=e.tabName,I=e.courses,D=e.isAdmin,_=e.tabChips,N=e.sortType,S=e.courseIds,A=e.isAdminMod,q=e.totalPages,W=e.isFiltered,V=e.adminFilter,K=e.currentGroup,L=e.initialFilterState,X=e.membershipBillingProducts,$=(0,g.useRouter)(),H=(0,y.bI)("isMobile","self"),Q=H.isMobile,U=H.self,J=H.dispatch,Y=(0,v.useState)(!1),ee=Y[0],et=Y[1],er=(0,v.useState)(!1),en=er[0],ei=er[1],ea=(0,v.useState)(null),es=ea[0],eo=ea[1],ec=(0,v.useRef)(),eu=(0,v.useRef)(!1),el=(0,v.useRef)(!1);(0,v.useEffect)(function(){return el.current=!0,function(){el.current=!1}},[]),(0,v.useEffect)(function(){var e;if(null!=K&&null!==(e=K.metadata)&&void 0!==e&&e.bulkActionInProgress){ei(!0);var t=setInterval((0,o.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.Z.getBulkActionProgress({groupID:K.id});case 3:0===e.sent.data.inProgress&&(ei(!1),clearInterval(t)),e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(0),clearInterval(t),e.abrupt("return");case 12:case"end":return e.stop()}},e,null,[[0,8]])})),1500);return function(){clearInterval(t)}}},[K]);var ep=(0,v.useMemo)(function(){return(0,x.yd)({member:null==U?void 0:U.member,group:K})},[U,K]),ed=(0,v.useMemo)(function(){var e=(0,s.Z)(T);return e[2].choices=I.filter(function(e){return!!e.privacy}),e[1].choices=[{key:"memberfreebillingproduct00000000",label:"Free"}].concat((0,s.Z)(X.map(function(e){return{key:e.id,label:"".concat((0,w.O5)(e),"/m")}}))),D||(e=e.filter(function(e){return!e.adminOnly})),e},[I,D,X]);(0,v.useEffect)(function(){es&&!eu.current&&(eu.current=!0,z(es),ec.current=setTimeout(function(){et(!0),ec.current=null},3e5))},[es]);var em=(0,v.useCallback)(function(e){(0,O.VF)($,(0,P.DW)({price:r,group:K,tab:k,page:e,levels:c,sortType:N,courseIds:S,online:a}))},[S,K,c,a,$,N,k,r]),eb=(0,v.useCallback)(function(){(0,O.VF)($,(0,P.DW)({group:K,tab:k}))},[K,$,k]),ef=(0,v.useCallback)(function(){J(C.fi,function(){return{settingsModal:D?"adminInvite":"userInvite"}})},[J,D]),ev=(0,v.useMemo)(function(){return ep?(0,B.jsx)(R,{label:"Invite",onClick:ef,icon:Q?"Add":void 0,variant:Q?"icon-round":void 0}):null},[ep,Q,ef]),ey=(0,v.useMemo)(function(){if(!(null!=i&&i.length)){var e=k===h.bI.GroupMembersPending?"No membership requests":"No members";return(0,B.jsx)(E,{children:e})}return(0,B.jsx)(M.t,{users:i})},[i,k]),eg=(0,v.useCallback)(function(e){var t=!!e.status.includes("admins")||void 0,r=!!e.status.includes("online")||void 0;(0,O.VF)($,(0,P.DW)({group:K,admin:t,online:r,levels:e.levels,tab:k,sortType:e.sortType,courseIds:e.courseIds,price:e.price}))},[K,k,$]),eh=(0,v.useCallback)(function(e){(0,O.VF)($,(0,P.DW)({group:K,tab:e.tab}))},[K,$]),ex=(0,v.useMemo)(function(){if(q>1)return(0,B.jsx)(l.t,{totalCount:n,currentPage:t,pageSize:30,onChange:em,style:{marginTop:Q?48:32}})},[em,Q,t,n,q]),ek=(0,v.useMemo)(function(){if("active"===k)return(0,B.jsx)(p.l,{xOffset:214,active:W,onReset:eb,options:ed,onApply:eg,initialState:L,children:Q?(0,B.jsx)(b.z,{variant:"icon",active:W,icon:"NewFilter",iconSize:16}):(0,B.jsx)(m.A,{label:"Filter",icon:"NewFilter",active:W})})},[k,Q,W,eb,ed,L,eg]),eO=(0,v.useCallback)((0,o.Z)(u().mark(function e(){var t,n,i,s,o;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(es&&!ee)){e.next=3;break}return z(es),e.abrupt("return");case 3:return ei(!0),et(!1),eu.current=!1,ec.current&&(clearTimeout(ec.current),ec.current=null),e.next=9,j.Z.membersBulkActions({groupID:K.id,type:"bulk-export-csv",allMembersSelected:!0,levels:c?c.split(",").map(function(e){return+e}):void 0,courseIds:S?S.split(",").map(function(e){return e}):void 0,price:r?r.split(","):void 0,online:!!a||void 0,admin:V||void 0,memberStatus:k,sortType:N});case 9:if(n=(t=e.sent).data,!t.error){e.next=16;break}return J(C.bI,{message:"There was an issue with your request, please try again.",severity:"error"}),ei(!1),e.abrupt("return");case 16:return i=n.token,s=n.fileId,e.prev=17,e.next=20,(0,G.Cx)({token:i,userID:null==U?void 0:U.id,timeoutMS:3e5});case 20:if(!el.current){e.next=26;break}return ei(!1),e.next=24,j.Z.getResourceUrl({fileId:s});case 24:o=e.sent,el.current&&eo(o.data);case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(17),J(C.bI,{message:"There was an issue with your request, please try again.",severity:"error"}),el.current&&ei(!1);case 32:case"end":return e.stop()}},e,null,[[17,28]])})),[ee,K,V,S,J,N,es,k,c,a,r,U]),ew=(0,v.useMemo)(function(){if(A&&!Q)return en?(0,B.jsx)(F,{children:(0,B.jsx)(f.D,{})}):(0,B.jsx)(m.A,{label:"Export",icon:"Export",onClick:eO})},[A,Q,eO,en]),eP=(0,v.useMemo)(function(){return(0,B.jsxs)(Z,{children:[(0,B.jsx)(d.u,{chipKey:"tab",chips:_,value:{tab:k},onChange:eh,scrollable:!0,style:{paddingRight:0}}),(0,B.jsxs)("div",{children:[ek,ew,ev]})]})},[k,_,ew,ev,ek,eh]);return(0,B.jsxs)("div",{children:[eP,ey,ex]})};K.getRenderData=(n=(0,o.Z)(u().mark(function e(t){var r,n,i,a,s,o,c,l,p,d,m,b;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.ctx,n=t.apiClient,i=(0,P.Z9)(r.query),a=(0,P.q$)(r.query),s=(0,P.XT)(r.query),c=(o=r.query).online,l=o.admin,p=o.sortType,d=o.levels,m=o.courseIds,b=o.price,e.next=7,n.readGroupMembersData({groupName:i,tabName:a,page:s,billingProductIds:b?b.split(","):void 0,levels:d?d.split(",").map(function(e){return+e}):void 0,courseIds:m?m.split(","):void 0,online:!!c,admin:!!l,limit:30,sortType:p});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),K.initPage=(i=(0,o.Z)(u().mark(function e(t){var r,n,i,a,s,o,c,l,p,d,m,b,f,v,y,g,O,w,j,I,M,C,T,D,_,N,S,Z,A,E,F,q,R,G,B,W,z,K,L;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.ctx,i=(n=t.props).currentGroup,a=n.self,s=(0,x.q2)({group:i,user:a,member:null==a?void 0:a.member}),o=(0,P.q$)(r.query)||(s?"active":"member"),c=(0,P.XT)(r.query),l=n.renderData,d=(p=r.query).online,m=p.admin,b=p.sortType,f=p.levels,v=p.courseIds,y=p.price,g=[],O=!1,l.courses&&(g=l.courses.map(function(e){return{key:e.id,label:e.title,privacy:e.privacy||0,minAccessLevel:e.minAccessLevel||null}})),w={status:[],levels:[]},d&&(w.status.push("online"),O=!0),m&&(w.status.push("admins"),O=!0),b&&(w.sortType=b,O=!0),w.sortType||"active"!==o||(w.sortType="-memberapprovedat"),f&&(w.levels=f.split(","),O=!0),v&&(w.courseIds=v.split(","),O=!0),y&&(w.price=y.split(","),O=!0),I=void 0===(j=l.totalCancellingMembers)?0:j,C=void 0===(M=l.totalFilteredMembers)?0:M,D=void 0===(T=l.totalChurnedMembers)?0:T,N=void 0===(_=l.totalOnlineMembers)?0:_,Z=void 0===(S=l.totalBannedMembers)?0:S,E=void 0===(A=l.totalMembers)?0:A,q=void 0===(F=l.totalAdmins)?0:F,R=0,e.t0=o,e.next="admin"===e.t0?23:"online"===e.t0?25:"banned"===e.t0?27:"churned"===e.t0?29:"cancelling"===e.t0?31:33;break;case 23:return R=q,e.abrupt("break",35);case 25:return R=N,e.abrupt("break",35);case 27:return R=Z,e.abrupt("break",35);case 29:return R=D,e.abrupt("break",35);case 31:return R=I,e.abrupt("break",35);case 33:return R=E,e.abrupt("break",35);case 35:return O&&(R=C),G=Math.ceil(R/30),B=(0,x.CP)({group:i,user:a,member:null==a?void 0:a.member}),W=s?[{key:"active",label:"Active \xa0".concat(O?C:E)},{key:"cancelling",label:"Cancelling \xa0".concat(I),dataTestId:"cancelled-members"},{key:"churned",label:"Churned \xa0".concat(D),dataTestId:"churned-members"},{key:"banned",label:"Banned",dataTestId:"banned-members"}]:[{key:"member",label:"Members \xa0".concat(E)},{key:"admin",label:"Admins \xa0".concat(q)},{key:"online",label:"Online \xa0".concat(N)}],z="Members \xb7 ".concat(i.metadata.displayName),K=l.members||[],L=(null==l?void 0:l.membershipBillingProducts)||[],s&&(K=K.map(function(e){var t=V({},e);if(e.member.billingProductId){var r=L.find(function(t){return t.id===e.member.billingProductId});t.member.pricing={amount:r.amount,currency:r.currency}}return t})),e.abrupt("return",V({tabName:o,tabChips:W,users:K,adminFilter:!!m,courses:g,page:c,totalPages:G,total:R,itemsPerPage:30,isAdmin:B,isAdminMod:s,initialFilterState:w,membershipBillingProducts:L,isFiltered:O,levels:f||"",sortType:b||"",courseIds:v||"",online:d||"",price:y||"",membersCount:[],settings:{pageTitle:z,pageMeta:{description:(0,k.Kv)({content:i.metadata.description})||""},mainMenuName:h.K0.GroupDefault,mainMenuItem:h.t5.GroupDefaultMembers,searchMembers:!0}},n));case 44:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)});var L=(0,I.Z)(K),X=r(78271),$=!0,H=(0,X.Z)(L)},42409:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[group]/-/members",function(){return r(28071)}])}},function(e){e.O(0,[4027,630,6911,6124,1613,2065,8271,842,8692,2888,9774,179],function(){return e(e.s=42409)}),_N_E=e.O()}]);