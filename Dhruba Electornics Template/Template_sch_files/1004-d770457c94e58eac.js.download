"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1004],{96212:function(e,t,n){n.d(t,{Z:function(){return e1}});var o=n(17674),r=n(90116),i=n(59499),s=n(73793),a=n(50029),l=n(64687),d=n.n(l),c=n(11163),u=n(67294),p=n(23450),m=n.n(p),f=n(14251),h=n(20338),v=n(96276),g=n(36581),x=n(65009),b=n(59607),y=n(86031),w=n(66703),j=n(95419),P=n(29610),C=n(30697),I=n(5095),O=n(12967),_=n(89557),Z=n(53531),k=n(91194),N=n(97221),D=n(81849),M=n(50378),S=n(20668),R=n(70299),L=M.ZP.div.withConfig({displayName:"styled__ChatIconWrapper",componentId:"sc-e4ns84-0"})(["padding:11px;"]),T=(0,M.ZP)(v.J).withConfig({displayName:"styled__ChatIcon",componentId:"sc-e4ns84-1"})(["color:",";height:18px;width:18px;"],f.O9.n5),E=M.ZP.div.withConfig({displayName:"styled__LikesCountWrapper",componentId:"sc-e4ns84-2"})(["cursor:pointer;"]),$=M.ZP.div.withConfig({displayName:"styled__LikesCount",componentId:"sc-e4ns84-3"})(["color:",";display:flex;align-items:center;padding:0px 4px;border-radius:20px;height:40px;cursor:pointer;",";&:hover{background-color:",";color:",";text-decoration:underline;}"],f.O9.n5,S.c.t8,f.O9.n3,f.O9.n7),U=M.ZP.div.withConfig({displayName:"styled__CommentsCount",componentId:"sc-e4ns84-4"})(["color:",";",";"],f.O9.n5,S.c.t8),V=(0,M.ZP)(x.X).withConfig({displayName:"styled__LikesRow",componentId:"sc-e4ns84-5"})(["transform:translateX(-10px);"]),W=(0,M.ZP)(x.X).withConfig({displayName:"styled__CommentsRow",componentId:"sc-e4ns84-6"})(["align-items:center;cursor:pointer;margin-right:8px;"]),H=(0,M.iv)(["box-shadow:",";"],function(e){return e.theme.isDarkTheme?R.nN:"0 1px 2px 0 rgba(60, 64, 67, 0.302), 0 1px 3px 1px rgba(60, 64, 67, 0.149)"}),A=(0,M.iv)(["border-radius:0px;box-shadow:none !important;border-left:none;border-right:none;"]),X=M.ZP.div.withConfig({displayName:"styled__PostItemWrapper",componentId:"sc-e4ns84-7"})(["background-color:",";cursor:pointer;border:1px solid ",";border-radius:10px;overflow:hidden;margin-bottom:16px;"," &:hover{","}",""],f.O9.n1,f.O9.n3,function(e){return e.$isDragging&&H},H,function(e){return e.theme.isMobile&&A}),z=n(85893),F=(0,u.memo)(function(e){var t,n,o=e.post,r=e.onVoteChange,i=e.newUpvotes,l=void 0===i?0:i,p=e.newCommentCount,m=e.reactionExtra,h=e.group,v=(0,u.useState)((null==o||null===(t=o.metadata)||void 0===t?void 0:t.myVote)||""),g=v[0],y=v[1],w=(0,u.useState)(parseInt(null==o||null===(n=o.metadata)||void 0===n?void 0:n.upvotes)||0),P=w[0],I=w[1],_=(0,c.useRouter)(),M=Math.max(o.metadata.comments||0,0),S=(0,s.bI)("isMobile"),R=S.isMobile,H=S.dispatch;(0,u.useEffect)(function(){var e,t;y((null==o||null===(e=o.metadata)||void 0===e?void 0:e.myVote)||""),I(parseInt(null==o||null===(t=o.metadata)||void 0===t?void 0:t.upvotes)||0)},[o]);var A=(0,u.useCallback)((0,a.Z)(d().mark(function e(){var t;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="up"===g?"":"up",e.next=3,j.Z.updatePostVote({postID:o.id,oldVote:g,newVote:t});case 3:if(!e.sent.error){e.next=7;break}return e.abrupt("return");case 7:y(t),I(function(e){return"up"===t?e+1:e-1}),null==r||r(g,t);case 10:case"end":return e.stop()}},e)})),[g,r,o.id]),X=(0,u.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),H(C.Qg,function(){return{postLikeModalProps:{post:o,group:h}}})},[H,o,h]);return(0,z.jsxs)(x.X,{flexGrow:1,alignItems:"center",justifyContent:"flex-start",children:[(0,z.jsxs)(V,{children:[(0,z.jsx)(N.Z,{reason:Z.lT.Upvote,onSuccess:A,onPending:function(){return(0,k.H5)(_)},showSignUp:!0,children:function(e){var t=e.onClick;return(0,z.jsx)(b.z,{variant:R?"icon-borderless-no-hover":"icon-borderless",icon:"up"===g?"ThumbsUpFilled":"ThumbsUp",onClick:t,iconSize:16.66,style:{color:"up"===g?f.O9.fgPrimary:void 0}})}}),(0,z.jsx)(D.I,{postID:o.id,upvotes:P,newUpvotes:l,children:(0,z.jsx)(E,{onClick:X,children:(0,z.jsx)($,{children:(0,O.TN)(P+l)})})})]}),(0,z.jsxs)(W,{children:[(0,z.jsx)(L,{children:(0,z.jsx)(T,{name:"Chat"})}),(0,z.jsx)(U,{children:(0,O.TN)(p+M)})]}),m]})}),B=n(73674),G=n(29677),J=n(15554),K=n(88325),q=n(40192),Q=n(76958),Y=n(60678),ee=n(63136),et=n(12065),en=n(15474),eo=n(4730),er=M.ZP.div.withConfig({displayName:"styled__PostItemCardWrapper",componentId:"sc-6yboky-0"})(["position:relative;padding:0px;width:100%;"]),ei=M.ZP.div.withConfig({displayName:"styled__PostItemCardContent",componentId:"sc-6yboky-1"})(["",""],function(e){var t=e.$padding;return"\n    padding: ".concat(t,";\n\n    &:first-child {\n      padding: ").concat(t,";\n    }\n\n    &:last-child {\n      padding: ").concat(t,";\n    }\n  ")}),es=(0,M.ZP)(b.z).withConfig({displayName:"styled__PostItemRemoveButton",componentId:"sc-6yboky-2"})(["position:absolute;top:8px;right:8px;"]),ea=["reports","content","onClick","isPinned","onCardClick","onRemove"];function el(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function ed(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?el(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):el(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ec=(0,u.memo)(function(e){var t=e.reports,n=e.content,o=e.onClick,r=e.isPinned,i=e.onCardClick,a=e.onRemove,l=(0,eo.Z)(e,ea),d=(0,s.bI)("isMobile").isMobile,c=(0,u.useRef)(),p=(0,u.useMemo)(function(){var e=d?"8px":"16px 16px 10px 0";return d&&!r&&(e="10px 10px 10px 0"),(r||t)&&(e="0px"),e},[d,r,t]),m=(0,u.useCallback)(function(e){i&&c.current&&c.current.contains(e.target)?i(e):o&&o(e)},[i,o]);return(0,z.jsx)(er,ed(ed({ref:c,onClick:m},l),{},{children:!!n&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ei,{$padding:p,children:n}),!!a&&(0,z.jsx)(es,{variant:"icon-borderless",icon:"Close",onClick:a,iconSize:16.66})]})}))}),eu=M.ZP.div.withConfig({displayName:"styled__PollBadgeWrapper",componentId:"sc-vh0utx-0"})(["display:flex;align-items:center;margin-top:8px;"]),ep=M.ZP.div.withConfig({displayName:"styled__PollBadge",componentId:"sc-vh0utx-1"})(["display:flex;align-items:center;border-radius:15px;border:1px solid ",";height:24px;justify-content:center;margin-right:8px;padding:0 12px;"],function(e){return e.$color}),em=M.ZP.div.withConfig({displayName:"styled__PinnedPostBanner",componentId:"sc-vh0utx-2"})(["height:37px;background:",";padding:",";display:flex;align-items:center;color:",";",""],function(e){return e.theme.isDarkTheme?f.O9.p2:"".concat(f.O9.p3,"95")},function(e){return e.theme.isMobile?"0 10px":"0px 16px"},function(e){return e.theme.isDarkTheme?f.O9.n2:f.O9.n7},S.c.t8),ef=M.ZP.div.withConfig({displayName:"styled__PinnedIconWrapper",componentId:"sc-vh0utx-3"})(["> div{height:16px;width:16px;margin-right:8px;}"]),eh=M.ZP.div.withConfig({displayName:"styled__HidePinWrapper",componentId:"sc-vh0utx-4"})(["margin-left:auto;"]),ev=M.ZP.div.withConfig({displayName:"styled__ActionStatusWrapper",componentId:"sc-vh0utx-5"})(["margin:8px 0;"]),eg=M.ZP.div.withConfig({displayName:"styled__TitleWrapper",componentId:"sc-vh0utx-6"})(["display:flex;align-items:center;"]),ex=M.ZP.div.withConfig({displayName:"styled__AttachmentCount",componentId:"sc-vh0utx-7"})(["",""],S.c.t7),eb=M.ZP.div.withConfig({displayName:"styled__ReportedLine",componentId:"sc-vh0utx-8"})(["color:",";",""],f.O9.e2,S.c.t6),ey=M.ZP.div.withConfig({displayName:"styled__PinLabel",componentId:"sc-vh0utx-9"})(["color:",";",""],f.O9.fgPrimary,S.c.t8),ew=M.ZP.div.withConfig({displayName:"styled__PollLabel",componentId:"sc-vh0utx-10"})(["color:",";",";line-height:1;"],f.O9.s2,S.c.t10),ej=M.ZP.div.withConfig({displayName:"styled__PostTimeContent",componentId:"sc-vh0utx-11"})(["color:",";white-space:nowrap;",""],f.O9.n5,S.c.t11),eP=M.ZP.span.withConfig({displayName:"styled__RecentActivityLabel",componentId:"sc-vh0utx-12"})(["color:",";",";"],function(e){return e.$color},function(e){var t=e.$variant;return S.c[t]}),eC=M.ZP.div.withConfig({displayName:"styled__GroupFeedLinkLabel",componentId:"sc-vh0utx-13"})(["color:",";&:hover{text-decoration:underline;}"," ",""],f.O9.n5,S.c.t10,S.c.ellipsis),eI=M.ZP.span.withConfig({displayName:"styled__HidePin",componentId:"sc-vh0utx-14"})(["cursor:pointer;&:hover{text-decoration:underline;}"]),eO=M.ZP.span.withConfig({displayName:"styled__UserLineLink",componentId:"sc-vh0utx-15"})(["&:hover{text-decoration:underline;}"]),e_=M.ZP.div.withConfig({displayName:"styled__Title",componentId:"sc-vh0utx-16"})(["overflow:hidden;word-break:break-word;& em{font-style:normal;background-color:",";color:",";}max-height:",";",";",";"],f.O9.p2,f.O9.fgPrimary,function(e){return e.theme.isMobile?"48px":"30px"},function(e){return e.theme.isMobile?S.c.t5:S.c.t2},function(e){return!e.theme.isMobile&&S.c.ellipsis}),eZ=M.ZP.div.withConfig({displayName:"styled__ContentPreviewWrapper",componentId:"sc-vh0utx-17"})(["color:",";overflow:hidden;word-break:break-word;max-height:","px;& em{font-style:normal;background-color:",";color:",";}",""],function(e){return e.$color},function(e){return 24*e.$maxLines},f.O9.p2,f.O9.fgPrimary,S.c.t7),ek=M.ZP.div.withConfig({displayName:"styled__CommentItem",componentId:"sc-vh0utx-18"})(["padding:",";"],function(e){return e.$reported?"0":"12px 0 6px 0"}),eN=M.ZP.div.withConfig({displayName:"styled__ConfirmModalWrapper",componentId:"sc-vh0utx-19"})(["",";"],function(e){return e.theme.isMobile&&"width: 100%;"}),eD=(0,M.ZP)(y.x).withConfig({displayName:"styled__PreviewImageWrapper",componentId:"sc-vh0utx-20"})(["align-items:center;justify-content:center;height:",";width:",";border-radius:10px;border:1px solid ",";margin-left:",";"," flex-shrink:0;position:relative;> div{z-index:1;}"],function(e){return e.theme.isMobile?"72px":"104px"},function(e){return e.theme.isMobile?"72px":"104px"},f.O9.n3,function(e){return e.theme.isMobile?"10px":"16px"},function(e){var t=e.theme,n=e.$hasRemoveButton;return!t.isMobile&&n&&"margin-top: 18px;"}),eM=M.ZP.img.withConfig({displayName:"styled__PreviewImage",componentId:"sc-vh0utx-21"})(['position:absolute;top:0;left:0;height:100%;width:100%;border-radius:10px;object-fit:cover;&:after{content:"";display:block;position:absolute;top:0;left:0;height:100%;width:100%;background-color:',";}"],f.O9.n1),eS=M.ZP.div.withConfig({displayName:"styled__Dot",componentId:"sc-vh0utx-22"})(["height:12px;width:12px;border-radius:50%;background-color:",";margin-right:8px;flex-shrink:0;display:inline-block;"],f.O9.sd1),eR=(0,M.ZP)(g.s).withConfig({displayName:"styled__PostItemCommentWrapper",componentId:"sc-vh0utx-23"})(["width:100%;min-width:0;background-color:",";padding:8px 13px;border-radius:15px;border:1px solid ",";"],function(e){return e.$reported?f.O9.p1:f.O9.n2},f.O9.n3),eL=(0,M.ZP)(y.x).withConfig({displayName:"styled__ReportWrapper",componentId:"sc-vh0utx-24"})(["flex-direction:",";align-items:",";justify-content:space-between;border-top:1px solid ",";padding-top:16px;padding-bottom:",";margin-top:",";margin-left:16px;"],function(e){return e.theme.isMobile?"column":"row"},function(e){return e.theme.isMobile?void 0:"center"},f.O9.n3,function(e){return e.theme.isMobile?"6px":"0px"},function(e){return e.$isComment?"0px":"8px"}),eT=(0,M.ZP)(g.s).withConfig({displayName:"styled__PostItemContentWrapper",componentId:"sc-vh0utx-25"})(["gap:8px;padding-left:16px;flex:1;overflow:hidden;height:100%;"]),eE=(0,M.ZP)(g.s).withConfig({displayName:"styled__PostMetadata",componentId:"sc-vh0utx-26"})(["max-width:calc(100% - 48px);"]),e$=M.ZP.div.withConfig({displayName:"styled__CommentsListWrapper",componentId:"sc-vh0utx-27"})(["margin-top:8px;padding-top:",";padding-bottom:",";margin-left:16px;border-top:1px solid ",";"],function(e){return e.$reported?"16px":"4px"},function(e){return e.$reported?"8px":"0px"},f.O9.n3);function eU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}var eV={POST:1,COMMENT:2},eW=(0,u.memo)(function(e){var t,n,o=e.post,r=e.maxLines,i=e.reports,s=(null==o||null===(t=o.metadata)||void 0===t?void 0:t.content)||"",a=(null==o||null===(n=o.metadata)||void 0===n?void 0:n.contentHl)||"";return a?(0,z.jsx)(eZ,{$maxLines:r||1,dangerouslySetInnerHTML:{__html:a}}):(0,z.jsx)(eZ,{$color:i?f.O9.fgPrimary:void 0,$maxLines:r||1,children:(0,P.Kv)({content:s})})}),eH=(0,u.memo)(function(e){var t,n,o=e.rootPost,r=e.comment,a=e.group,l=e.reports,d=(0,c.useRouter)(),p=(0,s.bI)("isMobile"),h=p.isMobile,v=p.dispatch,g=(0,u.useMemo)(function(){var e,t;return null==r||null===(e=r.metadata)||void 0===e||null===(e=e.attachments)||void 0===e||null===(t=e.split)||void 0===t?void 0:t.call(e,",")},[null==r||null===(t=r.metadata)||void 0===t?void 0:t.attachments]),b=(0,u.useCallback)(function(e){e.stopPropagation(),e.preventDefault();var t=r.id?r.id.substr(0,8):void 0;if(h){var n=(0,I.P_)({groupName:a.name,postName:o.name,selectedPostID:t}),s=n.href,l=n.as;d.push(s,l)}else{var c={pathname:d.pathname,query:{group:a.name,postName:o.name,selectedPostID:t}},u="/".concat(a.name,"/").concat(o.name);v(C.Rq,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eU(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eU(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},d)),d.push(c,u,{scroll:!1,shallow:!0})}},[null==r?void 0:r.id,v,null==a?void 0:a.name,h,null==o?void 0:o.name,d]);return(0,z.jsx)(ek,{$reported:!!l,children:(0,z.jsxs)(x.X,{alignItems:"flex-start",width:"100%",children:[(0,z.jsx)(y.x,{marginRight:8,children:(0,z.jsx)(B.Z,{group:a,user:r.user,size:40,userPreview:!0,showLevel:!0})}),(0,z.jsxs)(eR,{onClick:b,$reported:!!l,children:[(0,z.jsx)(_.Z,{userNameColor:l?f.O9.fgPrimary:f.O9.n7,post:r,hideAvatar:!0,hideEdited:!0,showVotes:!l,group:a}),!!r&&(0,z.jsx)(eW,{post:r,maxLines:2,reports:l}),!(null!=r&&null!==(n=r.metadata)&&void 0!==n&&n.content)&&g&&(0,z.jsx)(ex,{children:"[".concat(m()("attachment",g.length),"]")})]})]})})}),eA=(0,u.memo)(function(e){var t=e.rootPost,n=e.comments,o=e.group,r=e.reports;return n.map(function(e){return e.userId?(0,z.jsx)(eH,{rootPost:t,comment:e,group:o,reports:r},e.id):null})});function eX(e){var t,n,o,r,i,l,p,P=e.postTree,C=e.group,_=e.showStats,N=e.onPostPinHide,D=e.onPostPinUnhide,M=e.isHighlighted,S=e.pinnedHighlight,R=e.commentingUsers,L=e.contributors,T=e.newCommentCount,E=e.lastCommentTimestamp,$=e.lastCommentIsSelf,U=e.reports,V=e.newUpvotes,W=e.pinnedPostsOnly,H=e.updatedPollVotes,A=e.onRemove,X=(0,u.useRef)(),eo=P.post,er=eo.metadata,ei=void 0===er?{}:er,es=ei.content||ei.contentHl,ea=(0,c.useRouter)(),el=(0,s.bI)("self","isMobile"),ed=el.self,eZ=el.isMobile,ek=(0,u.useRef)(!1),eR=(0,I.W7)(ea.query),eU=ei.deleted?null:eo.user,eH=(0,u.useRef)(),eX=(0,u.useRef)((0,K.ur)({value:eo.createdAt,partialAgo:!0})),ez=(0,u.useMemo)(function(){var e,t;return null!==(e=null==P||null===(t=P.children)||void 0===t?void 0:t.map(function(e){return e.post}))&&void 0!==e?e:[]},[P]),eF=(null==eo||null===(t=eo.metadata)||void 0===t?void 0:t.pinned)!==void 0&&!U;eR||U||(eF=(null==eo||null===(p=eo.metadata)||void 0===p?void 0:p.pinned)===1);var eB=eF&&(null==eo||null===(n=eo.metadata)||void 0===n?void 0:n.hidden)===1,eG=(0,u.useState)(function(){return function(e){if(!(null!=e&&e.metadata))return null;if(e.metadata.rca){var t=e.metadata.rca.split("|");return{activityType:parseInt(t[0]),timestamp:parseInt(t[1])}}return e.metadata.lastComment?{activityType:2,timestamp:e.metadata.lastComment}:null}(eo)}),eJ=eG[0],eK=eG[1],eq=Math.max((null==eo||null===(o=eo.metadata)||void 0===o?void 0:o.myView)||0,(null==eo||null===(r=eo.metadata)||void 0===r?void 0:r.lastCommentView)||0),eQ=((null==eJ?void 0:eJ.timestamp)||0)>eq,eY=!!eq,e0=(0,u.useMemo)(function(){var e,t;return null==eo||null===(e=eo.metadata)||void 0===e||null===(e=e.attachments)||void 0===e||null===(t=e.split)||void 0===t?void 0:t.call(e,",")},[null==eo||null===(i=eo.metadata)||void 0===i?void 0:i.attachments]);(0,u.useEffect)(function(){E&&eK({activityType:eV.COMMENT,timestamp:E})},[E]),(0,u.useEffect)(function(){return ek.current=!0,function(){ek.current=!1}},[]);var e1=(0,u.useCallback)(function(){var e;null==eH||null===(e=eH.current)||void 0===e||e.click()},[]),e6=(0,u.useCallback)(function(e,t){var n=(0,O.W4)(e),o=n.firstName,r=n.lastName;return(0,z.jsx)(w.u,{content:"".concat(o," ").concat(r," ").concat(0===t?"- First commenter":1===t?"- Second commenter":"- Recent commenter"),children:(0,z.jsx)(B.Z,{user:n,size:25,disableLink:!0})},t)},[]),e9=(0,u.useCallback)(function(e){e.stopPropagation(),null==A||A(eo)},[A,eo]),e2=(0,u.useMemo)(function(){if(!(null!=eo&&null!==(e=eo.metadata)&&void 0!==e&&e.pollData))return null;var e,t=H;"number"!=typeof t&&(t=(JSON.parse(eo.metadata.pollData).entries||[]).reduce(function(e,t){return e+t.count},0));var n=t?"".concat(m()("member",t,!0)," ").concat(m()("have",t)," voted"):"Cast your vote";return(0,z.jsxs)(eu,{children:[(0,z.jsx)(ep,{$color:f.O9.s2,children:(0,z.jsx)(ew,{children:"Poll"})}),(0,z.jsx)(ew,{children:n})]})},[null==eo||null===(l=eo.metadata)||void 0===l?void 0:l.pollData,H]),e8=(0,u.useMemo)(function(){if(!eJ)return null;var e=eQ&&!$,t=e?f.O9.sd1:f.O9.n5;switch(eJ.activityType){case eV.POST:return null;case eV.COMMENT:return(0,z.jsx)(eP,{$variant:e?"t10":"t11",$color:t,children:"".concat(e?"New":"Last"," comment ").concat((0,K.ur)({value:eJ.timestamp,justNow:!0,partialAgo:!0}))})}},[eJ,eQ,$]),e4=(0,u.useMemo)(function(){var e=[];return!eZ&&(L&&e.push((0,z.jsx)(x.X,{gap:2,alignItems:"center",children:L.slice(0,5).map(e6)},"avatar")),null!=R&&R.length&&e.push((0,z.jsx)(y.x,{marginLeft:8,children:(0,z.jsx)(J.Z,{})},"typing"))),e8&&e.push((0,z.jsx)(y.x,{marginLeft:e.length?16:0,children:e8},"rcat")),e.length?(0,z.jsx)(x.X,{marginLeft:eZ?24:16,alignItems:"center",children:e}):null},[eZ,R,L,e8,e6]),e5=(0,u.useCallback)(function(e){e.stopPropagation(),e.preventDefault(),N&&N(eo)},[N,eo]),e3=(0,u.useCallback)(function(e){e.stopPropagation(),e.preventDefault(),D&&D(eo)},[D,eo]),e7=(0,u.useMemo)(function(){return eF?(0,z.jsxs)(em,{children:[(0,z.jsx)(ef,{children:(0,z.jsx)(v.J,{name:"NewPin"})}),"Pinned",(0,z.jsx)(eh,{children:eB?(0,Z.nV)({member:null==ed?void 0:ed.member,group:C})&&(0,z.jsx)(eI,{onClick:e3,children:(0,z.jsx)(ey,{children:W?"Unhide from feed":"Unhide"})}):(0,Z.mv)({member:null==ed?void 0:ed.member,group:C})&&(0,z.jsx)(eI,{onClick:e5,children:(0,z.jsx)(ey,{children:W?"Hide from feed":"Hide"})})})]}):null},[eF,eB,e5,e3,C,ed,W]),te=(0,u.useMemo)(function(){var e,t,n,o,r=ei.imagePreviewSmall,i=ei.videoLinks,s=ei.title,l=!r||C.metadata.noImagePreview,c=function(){return l?null:(0,z.jsxs)(eD,{$hasRemoveButton:!!A,children:[(0,z.jsx)(eM,{src:encodeURI(r),loading:"lazy",alt:s}),i&&(0,z.jsx)(G.Z,{fillOpacity:.8,width:45,height:29})]})},u=(ei.labels||"").split(","),p=C.labels.find(function(e){return e.id===u[0]});return(0,z.jsxs)(g.s,{gap:eF?0:8,children:[e7,(0,z.jsxs)(x.X,{alignItems:"center",padding:eF&&!eZ?16:eF&&eZ?10:void 0,paddingLeft:0,paddingBottom:eF&&!eZ?10:void 0,children:[(0,z.jsxs)(eT,{children:[(0,z.jsxs)(x.X,{alignItems:"center",children:[(0,z.jsx)(y.x,{marginRight:8,children:(0,z.jsx)(B.Z,{user:eU,group:C,size:40,userPreview:!0,showLevel:!0})}),(0,z.jsxs)(eE,{children:[(0,z.jsx)(Q.Z,{hoverUnderline:!0,user:eU,group:C,component:"div",typographyVariant:"t6",userPreview:!0,showLevelTitle:!0}),(0,z.jsxs)(x.X,{children:[(0,z.jsx)(q.Z,{post:eo,children:(0,z.jsxs)(ej,{children:[eX.current,"\xa0"]})}),(0,z.jsxs)(ej,{children:["in","\xa0"]}),(0,z.jsx)(Y.Z,{group:C,category:null==p?void 0:p.id,style:{overflow:"hidden"},children:(0,z.jsxs)(eC,{children:[eZ&&"â€¢ ",null==p?void 0:p.metadata.displayName]})})]})]})]}),(0,z.jsx)(ee.Z,{groupName:C.name,postName:eo.name,children:null!=eo&&null!==(e=eo.metadata)&&void 0!==e&&e.titleHl?(0,z.jsx)(x.X,{children:(0,z.jsxs)(eg,{ref:eH,children:[!eY&&!U&&(0,z.jsx)(eS,{}),(0,z.jsx)(e_,{dangerouslySetInnerHTML:{__html:null==eo||null===(t=eo.metadata)||void 0===t?void 0:t.titleHl}})]})}):(0,z.jsx)(eg,{ref:eH,children:(0,z.jsxs)(e_,{children:[!eY&&!U&&(0,z.jsx)(eS,{}),eo.metadata.title]})})}),es?(0,z.jsx)(y.x,{marginBottom:2,children:eZ?(0,z.jsxs)(x.X,{justifyContent:"space-between",alignItems:"center",flexGrow:1,children:[(0,z.jsx)(eW,{post:eo,maxLines:l?2:3}),c()]}):(0,z.jsx)(eW,{post:eo,maxLines:2})}):eZ?(0,z.jsxs)(x.X,{children:[(0,z.jsx)("div",{}),c()]}):e0?(0,z.jsx)(ex,{children:"[".concat(m()("attachment",e0.length),"]")}):l?(0,z.jsx)(y.x,{height:8}):(0,z.jsx)(y.x,{height:12}),!!(null!=eo&&null!==(n=eo.metadata)&&void 0!==n&&n.action)&&(0,z.jsx)(ev,{children:(0,z.jsx)(en.Z,{completed:!!(null!=eo&&null!==(o=eo.metadata)&&void 0!==o&&o.actionCompleted)})}),e2,_&&(0,z.jsx)(F,{post:eo,group:C,newCommentCount:T,showNumComments:!0,reactionExtra:e4,newUpvotes:V})]}),!eZ&&c()]}),!!ez.length&&(0,z.jsx)(e$,{$reported:!!U,children:(0,z.jsx)(eA,{rootPost:eo,comments:ez,group:C,reports:U})}),function(){if(!U)return null;var e,t,n=P.reportUsers,o=P.isComment,r=P.count,i=o?P.children[0].post.id:P.post.id,s=(e=(0,a.Z)(d().mark(function e(t){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),t.stopPropagation(),e.next=4,j.Z.resetReports({postID:i});case 4:return e.next=6,(0,k.H5)(ea);case 6:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),l=(t=(0,a.Z)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.Z.deletePost({postID:i});case 2:return e.next=4,(0,k.H5)(ea);case 4:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),c=function(e){return"".concat(e.firstName," ").concat(e.lastName)},u=function(e,t){e.stopPropagation(),e.preventDefault();var n=(0,I.sB)({userName:null==t?void 0:t.name,group:C});window.open(n.as)};return(0,z.jsxs)(eL,{$isComment:o,children:[(0,z.jsx)(eb,{children:1===r?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(et.Z,{component:"span",user:{id:n[0].id},group:C,children:(0,z.jsx)(eO,{onClick:function(e){return u(e,n[0])},children:c(n[0])})})," reported this ".concat(o?"comment":"post")]}):2===r?null==n?void 0:n.map(function(e,t){return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(et.Z,{component:"span",user:{id:e.id},group:C,children:(0,z.jsx)(eO,{onClick:function(t){return u(t,e)},children:c(e)})}),0===t?" and ":" reported this ".concat(o?"comment":"post")]})}):(0,z.jsxs)(z.Fragment,{children:[null==n?void 0:n.map(function(e){return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(et.Z,{component:"span",user:{id:e.id},group:C,children:(0,z.jsx)(eO,{onClick:function(t){return u(t,e)},children:c(e)})}),", "]})}),"and ".concat(m()("other",r-2,!0)," reported this ").concat(o?"comment":"post")]})}),(0,z.jsxs)(x.X,{gap:16,alignSelf:eZ?"flex-end":void 0,marginTop:eZ?16:void 0,width:eZ?"100%":void 0,onClick:function(e){e.stopPropagation(),e.preventDefault()},children:[(0,z.jsx)(b.z,{variant:"secondary",label:"Keep",onClick:s}),(0,z.jsx)(eN,{children:(0,z.jsx)(h.s,{header:"Delete ".concat(o?"comment":"post","?"),content:"Are you sure you want to delete? You can't undo this",confirmLabel:"Delete",onConfirm:l,children:(0,z.jsx)(b.z,{variant:"secondary",label:"Delete"})})})]})]})}()]})},[eo,C,es,_,eZ,e4,ez,eY,ei,T,e7,eF,U,P,ea,V,eU,e2,e0,A]),tt=(0,u.useMemo)(function(){var e={};return eZ&&(e.borderRadius=0,e.borderLeftWidth=0,e.borderRightWidth=0),M&&(S&&eF||!S&&!eF)&&(e.animation="bg-fade-out-comment ease-in 4s"),eF&&(e.padding=0),U&&(e.padding="16px 16px 11px 0"),e},[M,eZ,eF,S,U]);return(0,z.jsx)("div",{ref:X,children:(0,z.jsx)(ec,{padding:eZ&&!eF?10:eF&&!U?0:16,content:te,onCardClick:e1,onRemove:A?e9:void 0,style:tt,isPinned:eF,reports:U})})}eX.defaultProps={showStats:!1,commentingUsers:[]};var ez=(0,u.memo)(eX),eF=n(15948),eB=n(50591),eG=n(75331),eJ=n(85064);function eK(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function eq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function eQ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eq(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eq(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eY=function(e){try{return JSON.parse(e.metadata.contributors).slice(0,5)}catch(e){return[]}};function e0(e){var t=e.group,n=e.postTrees,a=e.showStats,l=e.onPostPinHide,d=e.onPostPinUnhide,p=e.highlightedPost,m=e.reports,f=e.removeDuplicates,h=e.pinnedPostsOnly,v=e.draggable,g=e.onDragEnd,x=e.onRemovePost,b=(0,s.bI)("updatedPostDetail","postDetailModal","self"),y=b.dispatch,w=b.updatedPostDetail,j=b.postDetailModal,P=b.self,O=(0,u.useRef)(!1),_=(0,u.useRef)({}),k=(0,u.useState)({}),N=k[0],D=k[1],M=(0,u.useRef)({}),S=(0,u.useState)({}),R=S[0],L=S[1],T=(0,u.useState)({}),E=T[0],$=T[1],U=(0,u.useState)({}),V=U[0],W=U[1],H=(0,u.useState)(n),A=H[0],F=H[1],B=(0,u.useState)(!1),G=B[0],J=B[1],K=(0,c.useRouter)();(0,u.useEffect)(function(){F(n)},[n]),(0,u.useEffect)(function(){y(C.Ks,A)},[y,A]),(0,u.useEffect)(function(){return O.current=!0,J(!0),function(){O.current=!1}},[]),(0,u.useEffect)(function(){var e=function(e){if(e.key===eG.H0.postRead&&e.newValue){var t=JSON.parse(e.newValue).value;F(function(e){return e.map(function(e){var n=e;return e.post.id===t&&((n=eQ({},e)).post.metadata.myView=1),n})})}};return window.addEventListener("storage",e),function(){window.removeEventListener("storage",e)}},[]),(0,u.useEffect)(function(){w&&(y(C.gQ,null),F(function(e){var t=(0,r.Z)(e),n=e.findIndex(function(e){return e.post.id===w.id});if(-1!==n){w.metadata.pinned&&!t[n].post.metadata.pinned&&(w.metadata.pinned=0);var o=eQ({},t[n]);if((0,I.YN)({pathname:K.pathname})){var s=eQ(eQ({},o.post.metadata),w.metadata);o.post=eQ(eQ({user:o.post.user},w),{},{metadata:s})}else o.post=eQ(eQ({user:o.post.user},w),{},{metadata:eQ({pollData:o.post.metadata.pollData},w.metadata)});t[n]=o,$(function(e){return eQ(eQ({},e),{},(0,i.Z)({},w.id,eQ(eQ({},e[w.id]),{},{newComments:0,lastCommentTimestamp:null})))}),D(function(e){return eQ(eQ({},e),{},(0,i.Z)({},w.id,{up:0,down:0}))})}return t}))},[w,K.pathname,y]);var q=(0,u.useCallback)(function(e){if(O.current){_.current[e.userId]&&clearTimeout(_.current[e.userId]);var t=e.topic.subId,n=M.current[t]||[];if(!n.find(function(t){return t.userId===e.userId})){var o=[].concat((0,r.Z)(n),[e]);L(function(e){var n=eQ(eQ({},e),{},(0,i.Z)({},t,o));return M.current=n,n})}_.current[e.userId]=setTimeout(function(){var o=n.filter(function(t){return t.userId!==e.userId});O.current&&L(function(e){var n=eQ(eQ({},e),{},(0,i.Z)({},t,o));return M.current=n,n})},e.duration)}},[]),Q=(0,u.useCallback)(function(e){if(O.current&&e.userId!==P.id&&A.find(function(t){return t.post.id===e.postId})){var t=A.find(function(e){return e.post.name===(null==j?void 0:j.postName)});t&&t.post.id===e.topic.subId&&e.userId===P.id||D(function(t){var n=t[e.topic.subId]||{up:0,down:0},o=e.oldVote,r=e.newVote;return"up"===o&&n.up--,"down"===o&&n.down--,"up"===r&&n.up++,"down"===r&&n.down++,eQ(eQ({},t),{},(0,i.Z)({},e.topic.subId,n))})}},[j,A,P]),Y=(0,u.useCallback)(function(e){if(O.current){$(function(t){var n;return eQ(eQ({},t),{},(0,i.Z)({},e.topic.subId,{newComments:null!==(n=t[e.topic.subId])&&void 0!==n&&n.newComments?t[[e.topic.subId]].newComments+1:1,lastCommentTimestamp:e.createdAt,lastCommentIsSelf:(null==e?void 0:e.userId)===(null==P?void 0:P.id)}))}),L(function(t){var n=eQ(eQ({},t),{},(0,i.Z)({},e.topic.subId,[]));return M.current=n,n});var t,n=null!==(t=V[e.parentId])&&void 0!==t?t:[],s=n.findIndex(function(t){return t.id===e.userId});if(0!==s&&1!==s){var a=(0,r.Z)(n);if(s>=2){var l=a.splice(s,1),d=(0,o.Z)(l,1)[0];a.push(d)}else{var c={id:e.userId,first_name:e.userFirstName,last_name:e.userLastName,metadata:{picture_bubble:e.userImage}};n.length<5||a.splice(2,1),a.push(c)}W(eQ(eQ({},V),{},(0,i.Z)({},e.parentId,a)))}}},[V,P]),ee=(0,u.useCallback)(function(e){var t=e.postId,n=e.pollData;O.current&&t&&"number"==typeof(null==n?void 0:n.voteCount)&&$(function(e){return eQ(eQ({},e),{},(0,i.Z)({},t,eQ(eQ({},e[t]),{},{updatedPollVotes:null==n?void 0:n.voteCount})))})},[]),et=(0,u.useCallback)(function(e){null!=e&&e.pollUpdated&&ee(e),null!=e&&e.userCommenting&&q(eQ(eQ({},null==e?void 0:e.userCommenting),{},{topic:null==e?void 0:e.topic,postId:null==e?void 0:e.postId})),null!=e&&e.newComment&&Y(eQ(eQ({},null==e?void 0:e.newComment),{},{topic:null==e?void 0:e.topic,postId:null==e?void 0:e.postId})),null!=e&&e.newPostVote&&Q(eQ(eQ({},null==e?void 0:e.newPostVote),{},{topic:null==e?void 0:e.topic,postId:null==e?void 0:e.postId}))},[ee,q,Y,Q]);(0,u.useEffect)(function(){if((0,Z.Rj)({member:null==P?void 0:P.member})){var e=[],n={};return A.forEach(function(o){n[o.post.id]||(n[o.post.id]=!0,e.push((0,eB.lF)(t.id,o.post.id)))}),(0,eB.Ld)(e,et)}},[P,t,A,et]),(0,u.useEffect)(function(){var e,t={},n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return eK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eK(e,t)}}(e))){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}(A);try{for(n.s();!(e=n.n()).done;){var o,r=e.value;null!=r&&null!==(o=r.post)&&void 0!==o&&null!==(o=o.metadata)&&void 0!==o&&o.contributors?t[r.post.id]=eY(r.post):t[r.post.id]=[]}}catch(e){n.e(e)}finally{n.f()}W(t)},[]);var en=(0,u.useMemo)(function(){for(var e={},n=[],o=G?A.length:5,r=0;r<A.length&&n.length<o;r++)if(function(){var o,i=A[r];if(f){if(void 0!==e[i.post.id]){if(e[i.post.id]!==r)return 1}else e[i.post.id]=r}var s=0;N[i.post.id]&&(s=N[i.post.id].up),n.push((0,z.jsx)(eF._l,{draggableId:i.post.id,index:n.length,isDragDisabled:!v,children:function(e,n){var o,r,c,u,f,v=eQ(eQ(eQ({},e.draggableProps),e.dragHandleProps),{},{ref:e.innerRef,style:null===(o=e.draggableProps)||void 0===o?void 0:o.style});return(0,z.jsx)(X,eQ(eQ({},v),{},{$isDragging:n.isDragging,children:(0,z.jsx)(ez,{reports:m,commentingUsers:R[i.post.id],newUpvotes:s,postTree:i,group:t,showStats:a,onPostPinHide:l,onPostPinUnhide:d,isHighlighted:!!p&&i.post.id.startsWith(p.postId),newCommentCount:(null===(r=E[i.post.id])||void 0===r?void 0:r.newComments)||0,lastCommentTimestamp:null===(c=E[i.post.id])||void 0===c?void 0:c.lastCommentTimestamp,lastCommentIsSelf:null===(u=E[i.post.id])||void 0===u?void 0:u.lastCommentIsSelf,updatedPollVotes:null===(f=E[i.post.id])||void 0===f?void 0:f.updatedPollVotes,contributors:null==V?void 0:V[i.post.id],pinnedHighlight:null==p?void 0:p.isPinned,pinnedPostsOnly:h,onRemove:x})}))}},"".concat(null!==(o=i.post.metadata)&&void 0!==o&&o.pinned?"pinned-":"").concat(i.post.id)))}())continue;return n},[R,t,p,N,l,d,h,A,f,m,a,E,G,V,v,x]);return(0,z.jsx)(eF.Z5,{onDragEnd:g,children:(0,z.jsx)(eF.bK,{droppableId:"posts-list-droppable",children:function(e){return(0,z.jsxs)("div",eQ(eQ({ref:e.innerRef},e.droppableProps),{},{children:[en,!G&&(0,z.jsx)(eJ.D,{fitWidth:!0}),e.placeholder]}))}})})}e0.defaultProps={showStats:!1};var e1=(0,u.memo)(e0)},42808:function(e,t,n){var o=n(50029),r=n(59499),i=n(64687),s=n.n(i),a=n(53531),l=n(5095),d=n(85893);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}t.Z=function(e){var t;function n(t){return(0,d.jsx)(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t))}return n.getRenderData=e.getRenderData,n.initPage=(t=(0,o.Z)(s().mark(function t(n){var o,r,i,d,c,u,p,m,f,h;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.ctx,r=n.props,i=n.apiClient,d=r.self,c=r.currentGroup,u=o.query,p=(0,l.aK)(u),m=(0,l.VO)(u),f=(0,l.kG)(u),(0,a.Wr)({member:null==d?void 0:d.member,group:c})){t.next=10;break}return h=(0,l.jQ)({invite:p,group:c,ref:f,pending:m}).as,t.abrupt("return",{settings:{redirect:{destination:h,permanent:!1}}});case 10:if(!e.initPage){t.next=16;break}return t.next=13,e.initPage({ctx:o,props:r,apiClient:i});case 13:t.t0=t.sent,t.next=17;break;case 16:t.t0=r;case 17:return t.abrupt("return",t.t0);case 18:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)}),n}}}]);