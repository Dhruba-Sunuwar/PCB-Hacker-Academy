(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2992],{47722:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSP:function(){return rx},default:function(){return ry}});var r,i,o=t(78271),a=t(50029),l=t(59499),s=t(64687),c=t.n(s),u=t(67294),d=t(73793),p=t(30697),f=t(75331),m=t(27849),v=t(42808),h=t(95419),b=t(29027),g=t(23450),x=t.n(g),y=t(5095),C=t(96276),w=t(70120),k=t(90116),j=t(11163),I=t.n(j),M=t(34811),P=t(42108),S=t(85893);function O(e){var n,t,r=e.course,i=e.onStartEditing,o=e.searchOverride,l=e.dropdownOptions,s=(0,d.bI)("isMobile","currentGroup"),f=s.isMobile,m=s.currentGroup,v=s.dispatch,h=(0,j.useRouter)(),b=(0,u.useState)(!1),g=b[0],x=b[1],C=(0,y.zh)(h),w=(0,y.ju)(h.query),I="menu"===w;(0,u.useEffect)(function(){if(f){var e=function(){x(window.scrollY>100)};return window.addEventListener("scroll",e),function(){window.removeEventListener("scroll",e)}}},[f]);var O=(0,u.useMemo)(function(){if(!f||!C)return null;var e,n=[{label:"Copy ".concat(I?"course":"page"," link"),onClick:(e=(0,a.Z)(c().mark(function e(){var n,t;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,y.rE)({group:m,course:r,courseModule:I?void 0:w}).as,t="".concat(location.origin).concat(n),e.next=4,navigator.clipboard.writeText(t);case 4:v(p.bI,{message:"".concat(I?"Course":"Page"," link copied")});case 5:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})}];return i&&n.push({label:"Edit",onClick:i}),l&&n.push.apply(n,(0,k.Z)(l)),n},[f,C,I,i,l,m,r,w,v]),Z=(0,u.useMemo)(function(){var e,n,t;return f?I||!g?{withDefaultTitle:!0,dropdownOptions:O,searchOverride:o}:{title:(0,S.jsx)(M.s,{scrollOnClick:!0,children:null!==(e=null==r||null===(n=r.metadata)||void 0===n?void 0:n.title)&&void 0!==e?e:null==m||null===(t=m.metadata)||void 0===t?void 0:t.displayName}),dropdownOptions:O,searchOverride:o}:null},[null==r||null===(n=r.metadata)||void 0===n?void 0:n.title,null==m||null===(t=m.metadata)||void 0===t?void 0:t.displayName,I,f,O,o,g]);(0,P.l)(P.C.COURSE,Z)}var Z=t(50378),_=t(20668),T=t(14251),D=Z.ZP.div.withConfig({displayName:"styled__NavRow",componentId:"sc-b0mpj5-0"})(["display:flex;width:100%;padding:11px 13px;justify-content:space-between;color:",";",";> a{display:flex;gap:8px;align-items:center;}> a > div{width:10px;}"],T.O9.secondary,_.c.t11),E=Z.ZP.div.withConfig({displayName:"styled__Title",componentId:"sc-b0mpj5-1"})(["text-overflow:ellipsis;overflow:hidden;",""],function(e){return e.theme.isMobile?_.c.t4:_.c.t2}),N=Z.ZP.ul.withConfig({displayName:"styled__Labels",componentId:"sc-b0mpj5-2"})(["margin:0;padding-left:16px;"]),L=(0,Z.iv)(["padding:0 13px 32px;width:100%;"]),A=Z.ZP.div.withConfig({displayName:"styled__Body",componentId:"sc-b0mpj5-3"})(["display:flex;flex-direction:column;gap:16px;padding-right:32px;width:50%;"," "," ",""],_.c.t7,function(e){return!e.$hasCoverImage&&"width: 100%;"},function(e){return e.theme.isMobile&&L}),R=(0,Z.iv)(["padding:0;flex-direction:column-reverse;"]),z=Z.ZP.div.withConfig({displayName:"styled__CourseOverviewWrapper",componentId:"sc-b0mpj5-4"})(["display:flex;justify-content:space-between;align-items:flex-start;width:100%;padding:32px;",""],function(e){return e.theme.isMobile&&R}),F=(0,Z.iv)(["width:100%;height:164px;border-radius:0;"]),$=Z.ZP.div.withConfig({displayName:"styled__CourseCover",componentId:"sc-b0mpj5-5"})(["width:365px;height:188px;background-size:cover;border-radius:10px;"," ",""],function(e){var n=e.$coverImage;return n&&'background-image: url("'.concat(n,'");')},function(e){return e.theme.isMobile&&F});function H(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return B(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return B(e,n)}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(l)throw o}}}}function B(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var U=(0,u.memo)(function(e){var n=e.course,t=n.course,r=n.children,i=void 0===r?[]:r,o=t.metadata,a=o.coverImage,l=o.desc,s=o.title,c=o.numModules,p=(0,d.bI)("isMobile","currentGroup"),f=p.isMobile,m=p.currentGroup;O({course:t});var v=(0,y.rE)({group:m,course:n.course,courseModule:"menu"}),h=(0,u.useMemo)(function(){var e,n=0,t=0,r=H(i);try{for(r.s();!(e=r.n()).done;){var o=e.value;if("set"===o.course.unitType&&n++,o.course.metadata.resources){var a=JSON.parse(o.course.metadata.resources);t+=a.length}if(o.children){var l,s=H(o.children);try{for(s.s();!(l=s.n()).done;){var u=l.value;if(u.course.metadata.resources){var d=JSON.parse(u.course.metadata.resources);t+=d.length}}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){r.e(e)}finally{r.f()}var p=x()("page",c,!0);return n>0&&(p="".concat(x()("folder",n,!0),", ").concat(p)),[p,x()("resource",t,!0)]},[i,c]);return(0,S.jsxs)(z,{children:[(0,S.jsxs)(A,{$hasCoverImage:!!a,children:[(0,S.jsx)(E,{title:s,children:s}),l,!!h.length&&(0,S.jsx)(N,{children:h.map(function(e,n){return(0,S.jsx)("li",{children:e},n)})})]}),f&&(0,S.jsx)(D,{children:(0,S.jsxs)(w.r,{href:v.as,children:[(0,S.jsx)(C.J,{name:"Left"}),"Course menu"]})}),a&&(0,S.jsx)($,{$coverImage:a})]})}),V=t(17674),W=t(15948),G=t(53531),q=t(12967),J=t(91194),Y=t(54361),X=t(38202),K=t(32983),Q=t(16531),ee=t(47691),en=t(59607),et=t(54408),er=t(22441),ei=(0,Z.ZP)(Q.mz).withConfig({displayName:"styled__ManageSetModalFooter",componentId:"sc-lg4egx-0"})(["display:flex;flex-direction:row;justify-content:space-between;align-items:center;"]),eo=(0,Z.iv)(["flex-direction:column-reverse;align-items:center;width:100%;gap:8px;"]),ea=Z.ZP.div.withConfig({displayName:"styled__ManageSetModalFooterButtonGroup",componentId:"sc-lg4egx-1"})(["display:flex;flex-direction:row;align-items:center;",""],function(e){return e.theme.isMobile&&eo}),el=(0,Z.ZP)(er.Z).withConfig({displayName:"styled__PublishedToggle",componentId:"sc-lg4egx-2"})(["",""],function(e){return e.theme.isMobile&&"margin-top: 16px;"}),es=(0,u.memo)(function(e){var n,t,r=e.open,i=e.course,o=e.setData,l=e.onClose,s=(0,u.useState)(null!==(n=null==o||null===(t=o.metadata)||void 0===t?void 0:t.title)&&void 0!==n?n:""),f=s[0],m=s[1],v=(0,u.useState)(null==o||!o.state||2===o.state),b=v[0],g=v[1],x=(0,u.useState)(!1),y=x[0],C=x[1],w=(0,j.useRouter)(),k=(0,d.bI)("currentGroup","isMobile"),I=k.currentGroup,M=k.isMobile,P=k.dispatch,O=(0,u.useCallback)(function(e){m(e.target.value)},[]),Z=(0,u.useCallback)(function(){g(!b)},[b]),_=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var n,t,r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(C(!0),!o){e.next=9;break}return e.next=4,h.Z.updateCourse({title:f.trim(),courseId:o.id});case 4:if(!(2===o.state!==b)){e.next=7;break}return e.next=7,h.Z.updateCourseState({courseId:o.id,state:b?"published":"draft"});case 7:e.next=19;break;case 9:return e.next=11,h.Z.createCourse({title:f.trim(),groupId:I.id,userId:self.id,state:b?2:1,unitType:"set",rootId:i.id,parentId:i.id});case 11:if(!(n=e.sent.error)){e.next=19;break}return r="Something went wrong, please try again",422===n.status&&null!=n&&null!==(t=n.data)&&void 0!==t&&null!==(t=t.fields)&&void 0!==t&&t.length&&(r=n.data.fields[0].error),C(!1),P(p.bI,{message:r,severity:"error"}),e.abrupt("return");case 19:return e.next=21,(0,J.H5)(w);case 21:P(p.bI,{message:o?"Folder updated":"Folder added"});case 22:case"end":return e.stop()}},e)})),[f,I,i,w,b,o,P]),T=(0,u.useMemo)(function(){var e=!f.trim()||f.length>et.f2;return o?e||f.trim()===o.metadata.title&&(b?2:1)===o.state:e},[f,o,b]);return(0,S.jsxs)(Q.u_,{open:r,size:"small",onClose:l,disableEscape:y,children:[(0,S.jsx)(Q.xB,{children:o?"Edit folder":"Add folder"}),(0,S.jsxs)(Q.fe,{children:[(0,S.jsx)(ee.I,{label:"Name",value:f,maxCharacters:et.f2,onChange:O}),M&&(0,S.jsx)(el,{active:b,label:b?"Published":"Draft",onClick:Z})]}),(0,S.jsxs)(ei,{children:[!M&&(0,S.jsx)(el,{active:b,label:b?"Published":"Draft",onClick:Z}),(0,S.jsxs)(ea,{children:[(0,S.jsx)(en.z,{label:"Cancel",variant:M?"secondary":"borderless",onClick:l,disabled:y}),(0,S.jsx)(en.z,{loading:y,label:o?"Save":"Add",disabled:T,onClick:_})]})]})]})}),ec=t(12476),eu=t(64597),ed=Z.ZP.div.withConfig({displayName:"styled__DropdownWrapper",componentId:"sc-14rd3g0-0"})(["> div > div:first-child{width:100%;> button{width:100%;}}"]);function ep(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var ef=(0,u.memo)(function(e){var n,t,r=e.open,i=e.courseChildren,o=e.module,l=e.onClose,s=(0,u.useState)(null),f=s[0],m=s[1],v=(0,u.useState)(!1),b=v[0],g=v[1],x=(0,j.useRouter)(),y=(0,d.bI)("isMobile"),C=y.isMobile,w=y.dispatch,k=(0,u.useMemo)(function(){var e,n=[{label:"None",onClick:function(){return m(null)},active:!f}],t=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return ep(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ep(e,n)}}(e))){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(l)throw o}}}}(i);try{for(t.s();!(e=t.n()).done;)!function(){var t=e.value;"set"===t.course.unitType&&n.push({label:t.course.metadata.title,onClick:function(){return m(t.course)},active:t.course===f})}()}catch(e){t.e(e)}finally{t.f()}return n},[i,f]);(0,u.useEffect)(function(){if((null==o?void 0:o.parentId)!==(null==o?void 0:o.rootId)){var e=i.find(function(e){return"set"===e.course.unitType&&e.course.id===(null==o?void 0:o.parentId)});m(null==e?void 0:e.course)}},[]);var I=(0,u.useCallback)((0,a.Z)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.next=3,h.Z.updateCourseParent({courseId:o.id,parent:f?f.id:o.rootId});case 3:return e.next=5,(0,J.H5)(x);case 5:w(p.bI,{message:"Page updated"});case 6:case"end":return e.stop()}},e)})),[o,f,x,w]),M=(0,u.useMemo)(function(){return(null==f?void 0:f.id)===(null==o?void 0:o.parentId)||!f&&(null==o?void 0:o.parentId)===(null==o?void 0:o.rootId)},[f,o]);return(0,S.jsx)(eu.T,{open:r,disabled:M,loading:b,header:"Change folder",confirmLabel:"Save",cancelButtonVariant:C?"secondary":"borderless",onConfirm:I,onCancel:l,onClose:l,children:(0,S.jsx)(ed,{children:(0,S.jsx)(ec.h_,{inputLabel:"Folder",label:null!==(n=null==f||null===(t=f.metadata)||void 0===t?void 0:t.title)&&void 0!==n?n:"None",variant:"input-floating-label",options:k,fitButton:!0})})})}),em=Z.ZP.div.withConfig({displayName:"styled__InputWrapper",componentId:"sc-1b5ub48-0"})(["display:inline-block;> div{display:inline-block;width:64px;margin:16px 8px 0;}"]);function ev(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function eh(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ev(Object(t),!0).forEach(function(n){(0,l.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ev(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var eb=(0,u.memo)(function(e){var n,t=e.open,r=e.module,i=e.onClose,o=(0,u.useMemo)(function(){if(!(null!=r&&null!==(e=r.metadata)&&void 0!==e&&e.dripConfig))return{enabled:!1,days:""};var e,n=JSON.parse(r.metadata.dripConfig);return eh(eh({},n),{},{days:n.days?String(n.days):""})},[null==r||null===(n=r.metadata)||void 0===n?void 0:n.dripConfig]),l=(0,u.useState)(o.enabled),s=l[0],f=l[1],m=(0,u.useState)(o.days),v=m[0],b=m[1],g=(0,u.useState)(!1),x=g[0],y=g[1],C=(0,j.useRouter)(),w=(0,d.bI)("isMobile"),k=w.isMobile,I=w.dispatch,M=(0,u.useCallback)((0,a.Z)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.next=3,h.Z.updateCourseDrip({courseId:r.id,enabled:s,days:v?+v:0});case 3:return e.next=5,(0,J.H5)(C);case 5:I(p.bI,{message:"Drip updated"});case 6:case"end":return e.stop()}},e)})),[r,s,v,C,I]),P=(0,u.useCallback)(function(e){var n=e.target.value,t=+n;(!n||t>=1&&t<=999)&&b(n)},[]),O=(0,u.useCallback)(function(){f(!s)},[s]),Z=(0,u.useMemo)(function(){return s&&!v||(null==o?void 0:o.enabled)===s&&(null==o?void 0:o.days)===v},[s,v,o]);return(0,S.jsxs)(eu.T,{open:t,disabled:Z,loading:x,header:"Edit drip",confirmLabel:"Save",cancelButtonVariant:k?"secondary":"borderless",onConfirm:M,onCancel:i,onClose:i,children:[(0,S.jsx)(er.Z,{active:s,label:s?"Drip ON":"Drip OFF",onClick:O,disableAnimation:!0}),s&&(0,S.jsxs)(em,{children:["Release page",(0,S.jsx)(ee.I,{value:v,onChange:P,inputProps:{"data-testid":"drip-input"}}),"days after members join"]})]})}),eg=t(85064),ex=t(71474),ey=(0,Z.iv)(["display:flex;height:40px;> button{background:unset;}"]),eC=(0,Z.ZP)(ec.h_).withConfig({displayName:"styled__CourseDropdownMenu",componentId:"sc-1wvgzj7-0"})(["align-items:center;height:40px;> button{background:",";}",""],T.O9.n2,function(e){return e.theme.isMobile&&ey}),ew=Z.ZP.div.withConfig({displayName:"styled__CourseMenuTopTitle",componentId:"sc-1wvgzj7-1"})(["display:flex;justify-content:space-between;align-items:center;min-height:40px;&:hover ","{display:flex;}"],eC),ek=(0,Z.ZP)(ec.h_).withConfig({displayName:"styled__MenuItemDropdownMenu",componentId:"sc-1wvgzj7-2"})(["align-items:center;height:40px;> button{background:",";}"," ",""],T.O9.n2,function(e){var n=e.theme,t=e.$forceDropdownVisible;return!n.isMobile&&!t&&"display: none;"},function(e){return e.theme.isMobile&&ey}),ej=(0,Z.iv)(["padding:0 13px;"]),eI=(0,Z.ZP)(C.J).withConfig({displayName:"styled__SetIcon",componentId:"sc-1wvgzj7-3"})(["padding:0 14px;color:",";"," ",""],T.O9.n5,function(e){return e.$expanded&&"transform: rotate(180deg);"},function(e){return e.theme.isMobile&&ej}),eM=(0,Z.ZP)(C.J).withConfig({displayName:"styled__ModuleCompletedIcon",componentId:"sc-1wvgzj7-4"})(["padding:0 10px;color:",";"],T.O9.success),eP=(0,Z.iv)(["padding:0 13px 0 4px;"]),eS=(0,Z.iv)(["background-color:"," !important;color:",";& ","{button{background-color:",";}}&:hover ","{button{background-color:",";&:hover{color:",";}}}"],T.O9.p2,T.O9.fgPrimary,ek,T.O9.p2,ek,T.O9.p2,T.O9.fgPrimary),eO=(0,Z.iv)(["&:hover{background-color:",";button{background-color:",";}}"," ",""],T.O9.n3,T.O9.n3,function(e){return!e.$isParent&&"padding: 12px 0 12px 24px;"},function(e){return e.$forceDropdownVisible&&"background-color: ".concat(T.O9.n3,";")}),eZ=Z.ZP.div.withConfig({displayName:"styled__MenuItemTitleWrapper",componentId:"sc-1wvgzj7-5"})(["display:flex;align-items:center;justify-content:space-between;width:100%;height:48px;padding:12px 0 12px 10px;border-radius:10px;> div{display:flex;align-items:center;}> div:first-child{min-width:0;}&:hover ","{","}&:hover ","{display:flex;}"," "," ",""],eM,function(e){var n=e.$isAdmin,t=e.theme;return n&&!t.isMobile&&"display: none;"},ek,function(e){return e.$active&&eS},function(e){var n=e.theme,t=e.$isSet;return!n.isMobile&&!t&&eO},function(e){return e.theme.isMobile&&eP}),e_=Z.ZP.div.withConfig({displayName:"styled__CourseMenuTopTitleText",componentId:"sc-1wvgzj7-6"})(["",""],_.c.ellipsis),eT=(0,Z.iv)(["padding:",";"],function(e){var n=e.$isSet,t=e.$isParent;return n?"0 8px":t?"0 8px 0 13px":"0 8px 0 48px"}),eD=Z.ZP.div.withConfig({displayName:"styled__MenuItemTitle",componentId:"sc-1wvgzj7-7"})(["padding-right:8px;"," "," ",""],_.c.ellipsis,function(e){return e.$isSet?_.c.t5:_.c.t7},function(e){return e.theme.isMobile&&eT}),eE=Z.ZP.div.withConfig({displayName:"styled__SetMenuItem",componentId:"sc-1wvgzj7-8"})(["display:flex;flex-direction:column;"]),eN=(0,Z.iv)(["transform:scale(1.05);"]),eL=Z.ZP.div.withConfig({displayName:"styled__MenuItemWrapper",componentId:"sc-1wvgzj7-9"})(["display:flex;flex-direction:column;cursor:",";transition:transform 300ms ease;border-radius:10px;",""],function(e){var n=e.$cursor;return void 0===n?"default":n},function(e){return e.$isHoveredOver&&eN}),eA=(0,Z.iv)(["width:100%;"]),eR=Z.ZP.div.withConfig({displayName:"styled__MenuItemsWrapper",componentId:"sc-1wvgzj7-10"})(["position:relative;",""],function(e){return e.theme.isMobile&&eA}),ez=(0,Z.F4)(["0%{opacity:0;}99%{opacity:0;}100%{opacity:1;}"]),eF=Z.ZP.div.withConfig({displayName:"styled__LoadingOverlay",componentId:"sc-1wvgzj7-11"})(["display:flex;height:100%;width:100%;align-items:center;justify-content:center;position:absolute;top:0;left:0;background:rgba(0,0,0,0.2);animation:"," 0.6s linear forwards;z-index:1;"],ez),e$=(0,Z.iv)(["width:100%;margin-bottom:16px;> div{padding:16px 13px 0 !important;}"]),eH=Z.ZP.div.withConfig({displayName:"styled__CourseMenuTop",componentId:"sc-1wvgzj7-12"})(["display:flex;flex-direction:column;margin-bottom:24px;"," > ","{padding-right:0;}> div{padding:0 10px;}",""],_.c.t4,ew,function(e){return e.theme.isMobile&&e$}),eB=Z.ZP.div.withConfig({displayName:"styled__DeleteSetOrModuleModalWrapper",componentId:"sc-1wvgzj7-13"})(["word-wrap:break-word;"]);function eU(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function eV(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?eU(Object(t),!0).forEach(function(n){(0,l.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eU(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function eW(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return eG(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return eG(e,n)}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(l)throw o}}}}function eG(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function eq(e){var n;return e?422===e.status&&null!=e&&null!==(n=e.data)&&void 0!==n&&null!==(n=n.fields)&&void 0!==n&&n.length?e.data.fields[0].error:"Something went wrong, please try again":""}function eJ(e){var n=e.course,t=e.children,r=e.isParent,i=e.draggingId,o=e.draggedOverId,s=e.draggableIndex,m=e.selectedModule,v=e.rootCourse,b=e.rootCourseChildren,g=e.saveScroll,C=e.onChildDragEnabled,k=e.onChildDragDisabled,I=(0,u.useState)(!1),M=I[0],P=I[1],O=(0,u.useState)(!1),Z=O[0],_=O[1],T=(0,u.useState)(!1),D=T[0],E=T[1],N=(0,u.useState)(!1),L=N[0],A=N[1],R=(0,u.useState)(!1),z=R[0],F=R[1],$=(0,d.bI)("self","currentGroup","completedModules","isMobile"),H=$.self,B=$.currentGroup,U=$.completedModules,q=$.isMobile,X=$.dispatch,K=(0,j.useRouter)(),Q=(0,Y.C1)(),ee=(0,V.Z)(Q,3),en=ee[0],et=ee[1],er=ee[2],ei=(0,Y.C1)(),eo=(0,V.Z)(ei,3),ea=eo[0],el=eo[1],ec=eo[2],ed=(0,Y.C1)(),ep=(0,V.Z)(ed,3),em=ep[0],ev=ep[1],eh=ep[2],eg=(0,Y.C1)(),ex=(0,V.Z)(eg,3),ey=ex[0],eC=ex[1],ew=ex[2],ej=n.metadata,eP=n.id,eS=n.unitType,eO=n.parentId,e_="set"===eS,eT=m===eP,eN=2===n.state,eA=(0,u.useMemo)(function(){return(0,G.CP)({user:H,member:null==H?void 0:H.member,group:B})},[H,B]),eR=!eA||q||D||L,ez=(0,u.useMemo)(function(){return!!e_&&(null==t?void 0:t.some(function(e){return e.course.id===m}))},[t,e_,m]);(0,Y.YB)(function(){if(ez){P(!0);return}var e=(0,f.tv)({key:f.H0.courseSetsExpanded}).value;if((null==e?void 0:e[n.id])!==void 0){P(!!e[n.id]);return}1===b.length&&P(!0)},[]);var eF=(0,u.useCallback)(function(){e_&&P(function(e){var t=(0,f.tv)({key:f.H0.courseSetsExpanded}).value;return(0,f.co)({key:f.H0.courseSetsExpanded,value:eV(eV({},t),{},(0,l.Z)({},n.id,!e))}),!e})},[e_,n.id]),e$=(0,u.useCallback)(function(){E(!0),null==k||k()},[k]),eH=(0,u.useCallback)(function(){E(!1),null==C||C()},[C]),eU=(0,u.useCallback)(function(){A(!0)},[]),eG=(0,u.useCallback)(function(){A(!1)},[]),eY=(0,u.useCallback)(function(){F(!0)},[]),eX=(0,u.useCallback)(function(){F(!1)},[]),eK=(0,u.useCallback)(function(e){e.preventDefault(),e.stopPropagation()},[]),eQ=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _(!0),e.next=3,h.Z.deleteCourse({courseId:eP});case 3:if(!(!e_&&eT)){e.next=9;break}return n=function(e,n){var t,r=eW(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=i.course,a=i.children;if("module"===o.unitType&&o.id!==n)return o;if(a){var l,s=eW(a);try{for(s.s();!(l=s.n()).done;){var c=l.value.course;if(c.id!==n)return c}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){r.e(e)}finally{r.f()}return null}(b,m),e.next=7,(0,J.VF)(K,(0,y.rE)({group:{name:B.name},course:v,courseModule:n?n.id:"overview"}));case 7:e.next=11;break;case 9:return e.next=11,(0,J.H5)(K);case 11:X(p.bI,{message:"".concat(e_?"Folder":"Page"," deleted")});case 12:case"end":return e.stop()}},e)})),[eP,K,X,e_,m,eT,b,v,B]),e0=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var t,r,i;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.createCourse({title:"New page",groupId:B.id,userId:H.id,state:2,unitType:"module",rootId:v.id,parentId:n.id,resources:"[]"});case 2:if(r=(t=e.sent).data,!(i=t.error)){e.next=8;break}return X(p.bI,{message:eq(i),severity:"error"}),e.abrupt("return");case 8:return e.next=10,(0,J.VF)(K,(0,y.rE)({group:{name:B.name},course:v,courseModule:r.id}));case 10:X(p.bI,{message:"Page added"});case 11:case"end":return e.stop()}},e)})),[n,B,X,v,K,null==H?void 0:H.id]),e1=(0,u.useCallback)((0,a.Z)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.updateCourseState({courseId:n.id,state:eN?"draft":"published"});case 2:return e.next=4,(0,J.H5)(K);case 4:X(p.bI,{message:eN?"Page reverted to draft":"Page published"});case 5:case"end":return e.stop()}},e)})),[n,X,eN,K]),e2=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var t,r,i,o,a,l,s,u,d,f,m,g,x,y,C,w,k;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.Z.getCourse({courseId:v.id});case 3:if(r=(t=e.sent).data,!t.error){e.next=9;break}return X(p.bI,{message:"Something went wrong, please try again",severity:"error"}),e.abrupt("return");case 9:return o=(i=function(e,n){for(var t=0;t<e.length;t++){var r=e[t],i=r.course,o=r.children;if(i.id===n)return i;if(o)for(var a=0;a<o.length;a++){var l=o[a].course;if(l.id===n)return l}}return null}(r.children,n.id).metadata).title,a=i.desc,l=i.transcript,s=i.resources,u=i.videoLink,d=i.videoThumbnail,f=i.videoLenMs,m=i.videoStream,g=i.dripConfig,e.next=13,h.Z.createCourse({groupId:B.id,userId:H.id,state:1,unitType:"module",title:o.startsWith("(Copy) ")?o:"(Copy) ".concat(o).slice(0,50),description:a,rootId:v.id,parentId:eO,videoLinkUrl:u,transcript:l,lenMs:f,thumbnail:d,resources:s,streamURL:m});case 13:if(y=(x=e.sent).data,!(C=x.error)){e.next=19;break}return X(p.bI,{message:eq(C),severity:"error"}),e.abrupt("return");case 19:if(!(null!==(w=function(e,n){for(var t=0;t<e.length;t++){var r=e[t],i=r.course,o=r.children;if(i.id===n)return t;if(o){for(var a=0;a<o.length;a++)if(o[a].course.id===n)return a}}return null}(b,n.id)))){e.next=23;break}return e.next=23,h.Z.moveCourse({courseId:y.id,newOrdinal:w+1});case 23:if(!g){e.next=27;break}return k=JSON.parse(g),e.next=27,h.Z.updateCourseDrip(eV({courseId:y.id},k));case 27:return e.next=29,(0,J.H5)(K);case 29:X(p.bI,{message:"Page duplicated"}),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(0),X(p.bI,{message:"Something went wrong, please try again",severity:"error"});case 35:case"end":return e.stop()}},e,null,[[0,32]])})),[n,B,X,eO,v,b,K,null==H?void 0:H.id]),e3=(0,u.useMemo)(function(){var e=r?e_?"set":"module":"setModule",n="".concat(e,"-").concat(eP);return r||(n+="-".concat(eO)),n},[eP,r,e_,eO]),e4=(0,u.useMemo)(function(){if(!i)return!1;var e=i.split("-");return"set"===(0,V.Z)(e,1)[0]&&e_},[i,e_]),e5=(0,u.useMemo)(function(){return e_?[{label:"Edit folder",onClick:et},{label:"Delete folder",onClick:eC},{label:"Add page in folder",onClick:e0}]:[]},[e_,et,eC,e0]),e9=(0,u.useMemo)(function(){var e=n.metadata.dripConfig&&JSON.parse(n.metadata.dripConfig);return null!=e&&e.enabled&&null!=e&&e.days?x()("day",e.days,!0):"Off"},[n]),e6=(0,u.useMemo)(function(){return e_?[]:[{label:"Edit page",onClick:function(){(0,J.VF)(K,(0,y.rE)({group:{name:B.name},course:v,courseModule:n.id,edit:!0}))}},{label:eN?"Revert to draft":"Publish page",onClick:e1},{label:"Change folder",onClick:el},{label:"Duplicate",onClick:e2},{label:"Drip status: ".concat(e9),onClick:ev},{label:"Delete",onClick:eC}]},[e_,eN,e1,el,e2,e9,ev,eC,K,B,v,n]),e7=e_&&o===e3&&!e4,e8=(0,S.jsxs)(eZ,{$active:eT||!M&&ez,$isAdmin:eA,$isSet:e_,$isParent:r,$forceDropdownVisible:z,onClick:eF,children:[(0,S.jsxs)("div",{children:[e_&&q&&(0,S.jsx)(eI,{name:"ArrowDown",$expanded:M}),(0,S.jsxs)(eD,{$isSet:e_,$isParent:r,title:ej.title,children:[!eN&&"(Draft) ",ej.title]})]}),(0,S.jsxs)("div",{children:[eA&&(0,S.jsx)("div",{onClick:eK,children:(0,S.jsx)(ek,{variant:"icon-borderless",icon:"HorizontalDots",options:e_?e5:e6,onMouseEnter:e$,onMouseLeave:eH,onShow:eY,onHide:eX,$forceDropdownVisible:z})}),e_&&!q&&(0,S.jsx)(eI,{name:"ArrowDown",$expanded:M}),!e_&&!z&&!!(null!=U&&U[eP])&&(0,S.jsx)(eM,{name:"CheckCircle"})]})]});if(!e_){var ne=(0,y.rE)({group:B,course:v,courseModule:n.id}).as;e8=(0,S.jsx)(w.r,{href:ne,onClick:g,children:e8})}return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(W._l,{draggableId:e3,index:s,isDragDisabled:eR,children:function(e){return(0,S.jsx)("div",eV(eV(eV({ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{children:(0,S.jsxs)(eL,{$isHoveredOver:e7,$cursor:eA?"grab":"pointer",children:[e8,e_&&(0,S.jsx)(W.bK,{droppableId:eP,type:"nestedDroppable",isDropDisabled:e4,children:function(e){return(0,S.jsxs)(eE,{ref:e.innerRef,children:[null==t?void 0:t.map(function(e,n){return M&&(0,S.jsx)(eJ,eV({isParent:!1,draggedOverId:o,draggableIndex:n,selectedModule:m,rootCourse:v,rootCourseChildren:b,saveScroll:g,onChildDragEnabled:eG,onChildDragDisabled:eU},e),e.course.id)}),e.placeholder]})}})]})}))}}),en&&(0,S.jsx)(es,{open:!0,course:v,setData:n,onClose:er}),ea&&(0,S.jsx)(ef,{open:!0,courseChildren:b,module:n,onClose:ec}),em&&(0,S.jsx)(eb,{open:!0,module:n,onClose:eh}),ey&&(0,S.jsx)(eu.T,{open:!0,loading:Z,course:v,header:"Delete ".concat(e_?"folder":"page","?"),confirmLabel:"Delete",confirmButtonVariant:"error",cancelButtonVariant:q?"secondary":"borderless",onConfirm:eQ,onClose:ew,onCancel:ew,children:(0,S.jsx)(eB,{children:"Are you sure you want to delete the ".concat(e_?"folder":"page",' "').concat(ej.title,"”? You can't undo this.")})})]})}var eY=(0,u.memo)(function(e){var n,t=e.course,r=e.selectedModule,i=e.saveScroll,o=e.onCourseUpdated,l=e.refetchCourses,s=(0,u.useState)(null),f=s[0],m=s[1],v=(0,u.useState)(null),b=v[0],g=v[1],x=(0,u.useState)(null),C=x[0],w=x[1],I=(0,d.bI)("currentGroup","self","completedModules","isMobile"),M=I.currentGroup,P=I.self,Z=I.completedModules,_=I.isMobile,T=I.dispatch,D=(0,j.useRouter)(),E=(0,Y.C1)(),N=(0,V.Z)(E,3),L=N[0],A=N[1],R=N[2],z=(0,Y.C1)(),F=(0,V.Z)(z,3),$=F[0],H=F[1],B=F[2],U=(0,Y.C1)(),Q=(0,V.Z)(U,3),ee=Q[0],en=Q[1],et=Q[2],er=t.course.metadata,ei=er.title,eo=er.numModules,ea=void 0===eo?1:eo,el=(0,u.useMemo)(function(){return(0,G.CP)({user:P,member:null==P?void 0:P.member,group:M})},[P,M]),ec=(0,u.useMemo)(function(){var e=0,n=Object.keys(null!=Z?Z:{}).filter(function(e){return Z[e]});return n.length?n.length<ea?e=Math.min(99,Math.max(1,Math.round(n.length/ea*100))):n.length===ea&&(e=100):e=0,e},[Z,ea]),eu=(0,u.useCallback)((0,a.Z)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:m(!1);case 3:case"end":return e.stop()}},e)})),[l]),ed=(0,u.useCallback)((n=(0,a.Z)(c().mark(function e(n){var r,i,a,l,s,u,d,f,v,b,g,x,y,C,w,j,I,M,P,S,O,Z,_,D,E,N,L;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),r=n.source,i=n.destination,a=n.draggableId,l=n.combine,s=r.index,u=a.split("-"),f=(d=(0,V.Z)(u,3))[0],v=d[1],b=d[2],!i){e.next=57;break}if(g=r.droppableId,x=i.droppableId,y=i.index,!(x!==g)){e.next=34;break}if(w=(C=(0,k.Z)(t.children)).findIndex(function(e){return e.course.id===g}),j=C.findIndex(function(e){return e.course.id===x}),I=C[w].children.findIndex(function(e){return e.course.id===v}),M=C[w].children[I],C[j].children){e.next=20;break}return C[j].children=[M],C[w].children.splice(I,1),o({children:C}),e.next=19,h.Z.updateCourseParent({courseId:v,parent:x});case 19:case 33:case 43:case 56:case 69:return e.abrupt("return",eu());case 20:return C[j].children=[].concat((0,k.Z)(C[j].children.slice(0,y)),[M],(0,k.Z)(C[j].children.slice(y))),C[w].children.splice(I,1),o({children:C}),e.next=25,h.Z.updateCourseParent({courseId:v,parent:x});case 25:if(!(C[j].children.length-1!==y)){e.next=33;break}return e.next=28,h.Z.moveCourse({courseId:v,newOrdinal:y});case 28:if(!e.sent.error){e.next=33;break}return m(!1),e.abrupt("return",T(p.bI,{message:"There was an issue with reordering.",severity:"error"}));case 34:if(!(s!==y)){e.next=57;break}if(!("setModule"!==f)){e.next=46;break}return o({children:(0,q.WR)({array:t.children,oldIdx:s,newIdx:y})}),e.next=39,h.Z.moveCourse({courseId:v,newOrdinal:y});case 39:if(!e.sent.error){e.next=43;break}return e.abrupt("return",T(p.bI,{message:"There was an issue with reordering.",severity:"error"}));case 46:return S=(P=(0,k.Z)(t.children)).findIndex(function(e){return e.course.id===b}),P[S].children=(0,q.WR)({array:P[S].children,oldIdx:s,newIdx:y}),o({children:P}),e.next=52,h.Z.moveCourse({courseId:v,newOrdinal:y});case 52:if(!e.sent.error){e.next=56;break}return e.abrupt("return",T(p.bI,{message:"There was an issue with reordering.",severity:"error"}));case 57:if(!("module"===f&&l)||(O=l.draggableId.split("-"),_=(Z=(0,V.Z)(O,2))[0],D=Z[1],"set"!==_)){e.next=70;break}return N=(E=(0,k.Z)(t.children)).findIndex(function(e){return e.course.id===v}),L=E.findIndex(function(e){return e.course.id===D}),E[L].children||(E[L].children=[]),E[L].children.push(E[N]),E.splice(N,1),o({children:E}),e.next=69,h.Z.updateCourseParent({courseId:v,parent:D});case 70:m(!1);case 71:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),[t,T,o,eu]),ep=(0,u.useCallback)(function(e){var n,t,r;g(null!==(n=null==e?void 0:e.draggableId)&&void 0!==n?n:null),w(null!==(t=null==e||null===(r=e.combine)||void 0===r?void 0:r.draggableId)&&void 0!==t?t:null)},[]),ef=(0,u.useCallback)(function(){ed.apply(void 0,arguments),w(null)},[ed]),em=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var n,r,i;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.createCourse({title:"New page",groupId:M.id,userId:P.id,state:2,unitType:"module",rootId:t.course.id,parentId:t.course.id,resources:"[]"});case 2:if(r=(n=e.sent).data,!(i=n.error)){e.next=8;break}return T(p.bI,{message:eq(i),severity:"error"}),e.abrupt("return");case 8:return e.next=10,(0,J.VF)(D,(0,y.rE)({group:{name:M.name},course:t.course,courseModule:r.id}));case 10:T(p.bI,{message:"Page added"});case 11:case"end":return e.stop()}},e)})),[t,M,T,D,null==P?void 0:P.id]),ev=(0,u.useMemo)(function(){return[{label:"Edit course",onClick:A},{label:"Add folder",onClick:en},{label:"Add page",onClick:em},{label:"Delete course",onClick:H}]},[A,en,em,H]);O({course:null==t?void 0:t.course,dropdownOptions:el?ev:void 0});var eh=_&&L;return(0,S.jsxs)(S.Fragment,{children:[!eh&&(0,S.jsx)(W.Z5,{onDragUpdate:ep,onDragEnd:ef,children:(0,S.jsx)(W.bK,{droppableId:"mainDroppable",type:"mainDroppable",isCombineEnabled:!0,children:function(e){var n;return(0,S.jsxs)(eR,{ref:e.innerRef,children:[(0,S.jsxs)(eH,{children:[(0,S.jsxs)(ew,{children:[(0,S.jsx)(e_,{title:ei,children:ei}),el&&!_&&(0,S.jsx)(eC,{variant:"icon-borderless",icon:"HorizontalDots",options:ev})]}),(0,S.jsx)(ex.u,{percentage:ec})]}),null==t||null===(n=t.children)||void 0===n?void 0:n.map(function(e,n){return(0,S.jsx)(eJ,eV({isParent:!0,draggingId:b,draggedOverId:C,draggableIndex:n,selectedModule:r,rootCourse:t.course,rootCourseChildren:t.children,saveScroll:i},e),e.course.id)}),e.placeholder,f&&(0,S.jsx)(eF,{children:(0,S.jsx)(eg.D,{})})]})}})}),L&&(0,S.jsx)(X.Z,{open:!0,inline:_,course:t.course,onClose:R}),$&&(0,S.jsx)(K.Z,{open:!0,course:t.course,source:"course",onClose:B}),ee&&(0,S.jsx)(es,{open:!0,course:t.course,onClose:et})]})}),eX=t(70299),eK=(0,Z.iv)(["display:flex;flex-direction:column;border-radius:0px;margin:0;"]),eQ=Z.ZP.div.withConfig({displayName:"styled__CourseWrapper",componentId:"sc-1penv8o-0"})(["width:100%;display:flex;margin:0 0 32px -5px;",""],function(e){return e.theme.isMobile&&eK}),e0=Z.ZP.div.withConfig({displayName:"styled__CourseMenuWrapper",componentId:"sc-1penv8o-1"})(["position:relative;width:100%;margin-top:-6px;padding-right:","px;max-width:","px;min-width:","px;"],32,360,274),e1=(0,Z.iv)(["max-width:none;min-width:0px;"]),e2=Z.ZP.div.withConfig({displayName:"styled__MainContent",componentId:"sc-1penv8o-2"})(["display:flex;flex-direction:column;width:100%;max-width:","px;min-width:","px;",""],725,494,function(e){return e.theme.isMobile&&e1}),e3=(0,Z.iv)(["min-height:100%;border:none;min-width:0px;border-radius:0;"]),e4=Z.ZP.div.withConfig({displayName:"styled__CourseContent",componentId:"sc-1penv8o-3"})(["display:flex;flex-direction:column;background:",";border:1px solid ",";"," border-radius:10px;position:relative;z-index:1;width:100%;height:fit-content;min-width:526px;"," ",""],T.O9.n1,T.O9.n3,function(e){return e.$editing&&"border-top: none;"},function(e){var n=e.theme;return e.$editing&&!n.isMobile&&eX.Wn},function(e){return e.theme.isMobile&&e3}),e5=t(67256),e9=t(31545),e6=t(97221),e7=t(73935),e8=t(64727),ne=t(42668),nn=t(71284),nt=t(86031),nr=t(65009),ni=Z.ZP.div.withConfig({displayName:"styled__RichTextEditorWrapper",componentId:"sc-1cnx5by-0"})(["position:relative;"]),no=(0,Z.iv)(["padding:",";"],function(e){return e.$readOnly?0:"13px 13px 0"}),na=Z.ZP.div.withConfig({displayName:"styled__EditorInnerWrapper",componentId:"sc-1cnx5by-1"})(["position:relative;padding:","px;",""],function(e){return e.$readOnly?0:24},function(e){return e.theme.isMobile&&no}),nl=(0,Z.ZP)(nn.kg).withConfig({displayName:"styled__EditorContentWrapper",componentId:"sc-1cnx5by-2"})(["> div{padding:16px 0 ","px;overflow:visible;> :first-child{margin-top:0;}> :last-child{margin-bottom:0;}}"],function(e){return e.$readOnly?0:32}),ns=Z.ZP.div.withConfig({displayName:"styled__RichTextEditorMenu",componentId:"sc-1cnx5by-3"})(["display:flex;align-items:center;background-color:",";position:sticky;top:",";z-index:2;border-top-left-radius:10px;border-top-right-radius:10px;border-top:1px solid ",";padding:",";"],T.O9.n2,function(e){return e.theme.isMobile?"52px":"64px"},T.O9.n3,function(e){return e.theme.isMobile?"7px":"8px"}),nc=(0,Z.iv)(["gap:0px;"]),nu=Z.ZP.div.withConfig({displayName:"styled__RichTextEditorMenuContent",componentId:"sc-1cnx5by-4"})(["display:flex;flex-wrap:wrap;",""],function(e){return e.theme.isMobile&&nc}),nd=Z.ZP.div.withConfig({displayName:"styled__RichTextEditorMenuContentGroupDivider",componentId:"sc-1cnx5by-5"})(["display:flex;margin:0 7px;align-self:center;width:1px;height:40px;background-color:",";"],T.O9.n3),np=Z.ZP.div.withConfig({displayName:"styled__ImageViewerRoot",componentId:"sc-1cnx5by-6"})(["z-index:1299;position:fixed;width:100vw;height:var(--rvh);top:0;left:0;min-width:",";"],function(e){return e.theme.isMobile?void 0:"600px"}),nf=Z.ZP.div.withConfig({displayName:"styled__ImageViewerHeader",componentId:"sc-1cnx5by-7"})(["z-index:1300;height:","px;width:100%;position:fixed;top:0;left:0;background-color:rgba(0,0,0,0.8);"],function(e){return e.$headerHeight}),nm=(0,Z.ZP)(nr.X).withConfig({displayName:"styled__ImageHeaderRow",componentId:"sc-1cnx5by-8"})(["align-items:center;justify-content:space-between;margin:0 8px 0 24px;height:100%;"]),nv=(0,Z.ZP)(nt.x).withConfig({displayName:"styled__ImageViewerContentWrapper",componentId:"sc-1cnx5by-9"})(["align-items:center;justify-content:center;z-index:1300;position:relative;height:",";width:100vw;margin-top:","px;"],function(e){var n=e.$headerHeight;return"calc(var(--rvh) - ".concat(n,"px)")},function(e){return e.$headerHeight}),nh=(0,Z.ZP)(nt.x).withConfig({displayName:"styled__ImageViewerContent",componentId:"sc-1cnx5by-10"})(["align-items:center;justify-content:center;position:relative;border-radius:10px;overflow:hidden;background-color:transparent;"]),nb=Z.ZP.div.withConfig({displayName:"styled__ImageViewerBackdrop",componentId:"sc-1cnx5by-11"})(["z-index:-1;position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.8);"]),ng=(0,u.forwardRef)(function(e,n){var t=e.editor,r=e.onUploadStart,i=e.onUploadEnd,o=e.extraItems,l=(0,d.bI)("currentGroup","isMobile"),s=l.currentGroup,f=l.isMobile,m=l.dispatch,v=(0,u.useState)(!1),b=v[0],g=v[1],x=(0,u.useState)({}),y=x[0],C=x[1],w=(0,u.useRef)(),k=(0,u.useCallback)(function(){C({heading1:t.isActive("heading",{level:1}),heading2:t.isActive("heading",{level:2}),heading3:t.isActive("heading",{level:3}),heading4:t.isActive("heading",{level:4}),bold:t.isActive("bold"),italic:t.isActive("italic"),strike:t.isActive("strike"),code:t.isActive("code"),bulletList:t.isActive("bulletList"),orderedList:t.isActive("orderedList"),blockquote:t.isActive("blockquote"),codeBlock:t.isActive("codeBlock"),link:t.isActive("link")})},[t]),j=(0,u.useCallback)(function(){C({})},[]);(0,u.useEffect)(function(){return t.on("selectionUpdate",k),t.on("focus",k),t.on("blur",j),function(){t.off("selectionUpdate",k),t.off("focus",k),t.off("blur",j)}},[t,k,j]);var I=(0,u.useCallback)(function(e,n){if(null!==(o=e.target)&&void 0!==o&&null!==(o=o.files)&&void 0!==o&&o.length){var o,l=e.target.files[0];if(!(0,e8.ZP)(l.type)){if(l.size>ne.Rj.attachmentImageFileMaxSize){m(p.bI,{message:"File too large, ".concat(ne.Rj.attachmentImageFileMaxSizeMB,"mb max"),severity:"error"});return}g(!0),r&&r(),(0,a.Z)(c().mark(function r(){var o,a,u,d,p,f,m,v;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,ne.s4)({file:l});case 2:if(o=r.sent,u=(a=(0,V.Z)(o,3))[0],!a[2]){r.next=10;break}return g(!1),i&&i(),r.abrupt("return",{error:"Failed to load image file"});case 10:return r.next=12,h.Z.createFile({fileName:l.name,contentType:l.type,contentLength:l.size,ownerID:null==s?void 0:s.id,largeThumbnail:!0});case 12:if(p=(d=r.sent).data,!(f=d.error)){r.next=20;break}return console.error("error creating file",f),g(!1),i&&i(),r.abrupt("return");case 20:return n?t.chain().focus().insertContentAt(n,[{type:"image",attrs:{src:u.toDataURL("image/jpeg"),alt:l.name,title:l.name,fileID:p.file.id}},{type:"paragraph"}]).run():t.chain().focus().insertContent([{type:"image",attrs:{src:u.toDataURL("image/jpeg"),alt:l.name,title:l.name,fileID:p.file.id}},{type:"paragraph"}]).run(),r.next=23,(0,e8.cT)({fileID:p.file.id,writeUrl:p.writeUrl,acl:p.acl,contentType:p.contentType,data:l,timeout:6e4});case 23:(m=r.sent)&&(v=document.getElementById(m.id))&&(v.src=m.metadata.readUrl,v.style.opacity="1.0"),e.target.value="",g(!1),i&&i();case 28:case"end":return r.stop()}},r)}))()}}},[s,t,r,i,m]),M=(0,u.useCallback)(function(){b||null==w||w.current.click()},[b]);(0,u.useImperativeHandle)(n,function(){return{handleImageAdd:I}});var P=(0,u.useCallback)(function(){if(t.isActive("link")){t.chain().focus().unsetLink().run();return}var e=window.prompt("Enter link URL:");if(e){e.startsWith("//")||e.startsWith("http://")||e.startsWith("https://")||(e="http://"+e);var n=t.state.selection,r=n.head,i=n.anchor;if(r===i){var o=(r>i?r:i)+e.length;return t.chain().focus().insertContent({type:"text",marks:[{type:"link",attrs:{href:e}}],text:e}).setTextSelection({from:o,to:o}).run()}var a=r>i?r:i;return t.chain().focus().setLink({href:e}).setTextSelection({from:a,to:a}).run()}},[t]),O=(0,u.useCallback)(function(e){return function(){e(),k()}},[k]);return t?(0,S.jsx)(ns,{children:(0,S.jsxs)(nu,{children:[(0,S.jsx)(en.z,{icon:"FormatH1",iconSize:20,onClick:O(function(){t.chain().focus().toggleHeading({level:1}).run()}),active:y.heading1,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Heading 1",disableRipple:!0}),(0,S.jsx)(en.z,{icon:"FormatH2",iconSize:20,onClick:O(function(){t.chain().focus().toggleHeading({level:2}).run()}),active:y.heading2,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Heading 2",disableRipple:!0}),(0,S.jsx)(en.z,{icon:"FormatH3",iconSize:20,onClick:O(function(){t.chain().focus().toggleHeading({level:3}).run()}),active:y.heading3,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Heading 3",disableRipple:!0}),(0,S.jsx)(en.z,{icon:"FormatH4",iconSize:20,onClick:O(function(){t.chain().focus().toggleHeading({level:4}).run()}),active:y.heading4,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Heading 4",disableRipple:!0}),(0,S.jsx)(nd,{}),(0,S.jsx)(en.z,{icon:"FormatBold",iconSize:24,onClick:O(function(){t.chain().focus().toggleBold().run()}),active:y.bold,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Bold",disableRipple:!0}),(0,S.jsx)(en.z,{icon:"FormatItalics",iconSize:24,onClick:O(function(){t.chain().focus().toggleItalic().run()}),active:y.italic,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Italic"}),(0,S.jsx)(en.z,{icon:"FormatStrikethrough",iconSize:24,onClick:O(function(){t.chain().focus().toggleStrike().run()}),active:y.strike,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Strikethrough",disableRipple:!0}),(0,S.jsx)(en.z,{icon:"FormatCodeInline",iconSize:24,onClick:O(function(){t.chain().focus().toggleCode().run()}),active:y.code,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Inline code",disableRipple:!0}),(0,S.jsx)(nd,{}),(0,S.jsx)(en.z,{icon:"FormatUnorderedList",iconSize:24,onClick:O(function(){t.chain().focus().toggleBulletList().run()}),active:y.bulletList,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Bullet list",disableRipple:!0}),(0,S.jsx)(en.z,{icon:"FormatOrderedList",iconSize:24,onClick:O(function(){t.chain().focus().toggleOrderedList().run()}),active:y.orderedList,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Numbered list",disableRipple:!0}),(0,S.jsx)(en.z,{icon:"FormatBlockQuote",iconSize:24,onClick:O(function(){t.chain().focus().toggleBlockquote().run()}),active:y.blockquote,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Blockquote",disableRipple:!0}),(0,S.jsx)(en.z,{icon:"FormatCodeBlock",iconSize:24,onClick:O(function(){t.chain().focus().toggleCodeBlock().run()}),active:y.codeBlock,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Code block",disableRipple:!0}),(0,S.jsx)(nd,{}),(0,S.jsx)(en.z,{icon:"Image",iconSize:20,onClick:M,variant:f?"icon-borderless-no-hover":"icon-borderless",disabled:b,title:"Image",disableRipple:!0}),(0,S.jsx)("input",{type:"file",style:{display:"none"},accept:"image/*",multiple:!1,onChange:I,id:"upload-image-input",ref:w}),(0,S.jsx)(en.z,{icon:"Link",iconSize:20,onClick:P,active:y.link,variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Link",disableRipple:!0}),(0,S.jsx)(en.z,{icon:"FormatHorizontalRule",iconSize:24,onClick:O(function(){t.chain().focus().setHorizontalRule().run()}),variant:f?"icon-borderless-no-hover":"icon-borderless",title:"Horizontal rule",disableRipple:!0}),o]})}):null}),nx=(0,u.memo)(ng),ny=t(20336),nC=t(26022),nw=t(52701),nk=t(58364),nj=t(34565),nI=t(30561),nM=t(51575),nP=t(7490),nS=t(67937),nO=t(73816),nZ=t(4281),n_=t(26761),nT=t(70273);function nD(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function nE(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nD(Object(t),!0).forEach(function(n){(0,l.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nD(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var nN=n_.Ee.extend({addOptions:function(){return{onClick:null}},addAttributes:function(){var e;return nE(nE({},null===(e=this.parent)||void 0===e?void 0:e.call(this)),{},{fileID:{default:""},originalSrc:{default:""}})},parseHTML:function(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML:function(e){var n,t,r=this,i=e.HTMLAttributes,o=e.node,a=document.createElement("div");a.setAttribute("style","display: flex; align-items: center; justify-content: center;");var l=document.createElement("img");return l.id=null===(n=o.attrs)||void 0===n?void 0:n.fileID,Object.entries((0,nT.P1)(this.options.HTMLAttributes,i)).forEach(function(e){var n=(0,V.Z)(e,2),t=n[0],r=n[1];return l.setAttribute(t,r)}),null!==(t=l.src)&&void 0!==t&&t.startsWith("data:")&&(l.style.transition="opacity 1s ease",l.style.opacity="0.3"),this.options.onClick&&(l.style.cursor="zoom-in",l.addEventListener("click",function(){var e,n,t;r.options.onClick({src:null==o||null===(e=o.attrs)||void 0===e?void 0:e.src,originalSrc:null==o||null===(n=o.attrs)||void 0===n?void 0:n.originalSrc,fileName:null==o||null===(t=o.attrs)||void 0===t?void 0:t.alt})})),a.appendChild(l),a}}),nL=t(73397),nA=t(25748),nR=t(99734),nz=t(57355),nF=t(83416),n$=t(99404),nH=t(35525),nB=nT.vc.create({name:"videoTimestamp",addOptions:function(){return{onClick:null}},addAttributes:function(){return{timestamp:{default:""}}},renderHTML:function(e){var n=this,t=e.HTMLAttributes,r=e.mark,i=document.createElement("span");return this.options.onClick&&(Object.entries((0,nT.P1)(t,{style:"text-decoration: underline; cursor: pointer"})).forEach(function(e){var n=(0,V.Z)(e,2),t=n[0],r=n[1];return i.setAttribute(t,r)}),i.addEventListener("click",function(){n.options.onClick(r.attrs.timestamp)})),i}}),nU=t(14760),nV=t(20452),nW=(0,u.memo)(function(e){var n=e.src,t=e.originalSrc,r=e.fileName,i=e.open,o=e.onClose,l=(0,d.bI)("isMobile"),s=l.isMobile,f=l.dispatch,m=null==t?void 0:t.startsWith("https://assets.skool.com/"),v=s?8:64,h=s?8:32,b=s?56:32;(0,u.useEffect)(function(){var e=!0,n=document.body.style.overflow;document.body.style.overflow="hidden";var t=window.onkeyup;window.onkeyup=function(n){e&&"Escape"===n.code&&o&&o()};var r=function(){var e=window.innerHeight;document.documentElement.style.setProperty("--rvh","".concat(e,"px"))};return r(),window.addEventListener("resize",r),function(){document.body.style.overflow=n,window.onkeyup=t,window.removeEventListener("resize",r),e=!1}},[o]);var g=(0,u.useCallback)(function(){o&&o()},[o]),x=(0,u.useCallback)((0,a.Z)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,e8.FA)({downloadURL:t||n,fileName:r});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),f(p.bI,{message:"Failed to download image",severity:"error"});case 8:case"end":return e.stop()}},e,null,[[0,5]])})),[n,t,r,f]),y=(0,u.useMemo)(function(){return r||t},[t,r]),C=(0,u.useMemo)(function(){var e={maxWidth:"calc(100vw - ".concat(2*v,"px)"),maxHeight:"calc(var(--rvh) - ".concat(56,"px - ").concat(h,"px - ").concat(b,"px)")};return(0,S.jsx)("img",{src:t||n,alt:r,style:e})},[n,t,r,v,h,b]);return i?(0,S.jsxs)(np,{children:[(0,S.jsx)(nf,{$headerHeight:56,children:(0,S.jsxs)(nm,{children:[(0,S.jsx)(nU.Z,{variant:"t5",color:(0,nV.$o)()?T.O9.n7:T.O9.n1,ellipsis:!0,style:{paddingRight:16},children:y}),(0,S.jsxs)(nr.X,{gap:8,children:[m&&(0,S.jsx)(en.z,{variant:"icon",icon:"Download",onClick:x,iconSize:16.66}),(0,S.jsx)(en.z,{variant:"icon",icon:"Close",onClick:g,iconSize:16.66})]})]})}),(0,S.jsxs)(nv,{$headerHeight:56,children:[(0,S.jsx)(nb,{onClick:g}),(0,S.jsx)(nh,{marginLeft:v,marginRight:v,marginTop:h,marginBottom:b,children:C})]})]}):null}),nG=nI.DY.extend({name:"unorderedList"}),nq=(0,u.forwardRef)(function(e,n){var t,r=e.initialContent,i=e.autoFocus,o=e.onChange,a=e.onFocus,l=e.onBlur,s=e.onKeyDown,c=e.readOnly,d=e.onVideoTimestampClick,p=e.onFileUploadStart,f=e.onFileUploadEnd,m=e.contentTop,v=e.contentBottom,h=e.extraMenuItems,b=(0,u.useRef)(null),g=(0,u.useRef)(0),x=(0,u.useRef)(!1),y=(0,u.useRef)(),C=(0,u.useState)(null),w=C[0],k=C[1],j=(0,u.useMemo)(function(){return!!(0,q.S_)()&&navigator.userAgent.toLowerCase().indexOf("android")>-1},[]);(0,u.useEffect)(function(){return x.current=!0,function(){x.current=!1}},[]);var I=(0,u.useCallback)(function(e){k({src:e.src,originalSrc:e.originalSrc,fileName:e.fileName})},[]),M=[ny.B,nC.n,nw.x,nk.A,nj.H,nG,nI.DY,nM.GS,nP.X.configure({levels:[1,2,3,4]}),nS.d8,nO.Tx,nZ.Re,nN.configure({allowBase64:!0,onClick:c?I:void 0,HTMLAttributes:{style:"max-height: ".concat(500,"px")}}),nL.m,nA.b,nR.V6,nz.EK,nF.dn,n$.r.configure({openOnClick:!1,HTMLAttributes:{rel:"noopener noreferrer",class:"link"}}),nB.configure({onClick:c?d:void 0}),nH.U];r&&(t={type:"doc",content:r});var P=(0,nn.jE)({content:t,editorProps:{attributes:{class:"skool-editor2"},handleDOMEvents:{keydown:function(e,n){null==s||s(n,null==e?void 0:e.state.selection.anchor)}},handlePaste:function(e,n){var t=null===(r=n.clipboardData)||void 0===r||null===(r=r.files)||void 0===r?void 0:r[0];if(!t)return!1;if(null!==(i=t.type)&&void 0!==i&&i.startsWith("image/")){var r,i,o,a,l=null==n||null===(o=n.target)||void 0===o?void 0:o.getBoundingClientRect(),s=null==e?void 0:e.posAtCoords({left:l.left,top:l.bottom+1});null===(a=y.current)||void 0===a||a.handleImageAdd({target:{files:[t]}},null==s?void 0:s.pos)}return!0},handleDrop:function(e,n,t,r){if(r)return!1;var i=null===(o=n.dataTransfer)||void 0===o||null===(o=o.files)||void 0===o?void 0:o[0];if(i&&null!==(a=i.type)&&void 0!==a&&a.startsWith("image/")){var o,a,l,s=e.posAtCoords({left:n.clientX,top:n.clientY});null===(l=y.current)||void 0===l||l.handleImageAdd({target:{files:[i]}},null==s?void 0:s.pos)}return!0}},extensions:M,autofocus:!!i,onCreate:function(e){var n=e.editor;o&&o(n.getJSON().content)},onUpdate:function(e){var n=e.editor;o&&o(n.getJSON().content)},onFocus:function(){a&&a()},onBlur:function(){l&&l()},editable:!c}),O=(0,u.useCallback)(function(){g.current>window.scrollY&&(null==P||P.commands.blur()),g.current=window.scrollY},[P]),Z=(0,u.useCallback)(function(e){var n;if(null!=e&&null!==(n=e.touches)&&void 0!==n&&n.length&&b.current){var t=b.current.getBoundingClientRect().top+window.scrollY-window.innerHeight,r=e.touches[0];r.pageY+r.screenY<t&&(null==P||P.commands.blur())}},[P]);(0,u.useEffect)(function(){if(j)return window.addEventListener("scroll",O),window.addEventListener("touchstart",Z),function(){window.removeEventListener("scroll",O),window.removeEventListener("touchstart",Z)}},[O,Z,j]),(0,u.useEffect)(function(){i&&P&&setTimeout(function(){try{P.commands.focus("end")}catch(e){}},0)},[i,P]);var _=(0,u.useCallback)(function(){k(null)},[]);return(0,u.useImperativeHandle)(n,function(){return{set:function(e){return!!x.current&&!!P&&P.chain().focus().setContent(e,!0).run()},insert:function(e){return!!x.current&&!!P&&P.chain().focus().insertContent(e).run()},clear:function(){return!!x.current&&!!P&&P.chain().focus().clearContent(!0).run()},focus:function(e){return!!x.current&&!!P&&P.commands.focus(e||void 0)}}}),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(ni,{$readOnly:c,ref:b,children:[!!P&&!c&&(0,S.jsx)(nx,{ref:y,editor:P,onUploadStart:p,onUploadEnd:f,extraItems:h}),(0,S.jsxs)(na,{$readOnly:c,children:[m,(0,S.jsx)(nl,{editor:P,$readOnly:c}),v]})]}),!!w&&(0,e7.createPortal)((0,S.jsx)(nW,{open:!0,onClose:_,src:w.src,originalSrc:w.originalSrc,fileName:w.fileName}),document.body)]})}),nJ=(0,u.memo)(nq),nY=t(96212);function nX(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return nK(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nK(e,n)}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(l)throw o}}}}function nK(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var nQ="[v2]",n0=/\b\d\d?:\d\d(?::\d\d)?\b/g,n1="videoTimestamp";function n2(e){if(!e)return"";var n,t="";if(e.text&&(t+=e.text),null!==(n=e.content)&&void 0!==n&&n.length){var r=e.content.map(n2);switch(e.type){case"unorderedList":case"bulletList":case"orderedList":t+="- "+r.join(" - ");break;default:t+=r.join("")}}return t}function n3(e){var n;if(!e.startsWith(nQ))return"";e=e.substring(nQ.length);try{n=JSON.parse(e)}catch(e){n=[{type:"paragraph"}]}return n}function n4(e){if("image"===e.type){var n;null!==(n=e.attrs.src)&&void 0!==n&&n.startsWith("data:")&&delete e.attrs.src}else e.content&&e.content.forEach(n4)}function n5(e){null==e||e.forEach(function e(n){if(null!==(t=n.content)&&void 0!==t&&t.length){var t,r,i=[],o=nX(n.content);try{for(o.s();!(r=o.n()).done;){var a,l,s=r.value;if("text"!==s.type||!(null!=s&&s.text)){e(s),i.push(s);continue}for(var c=null!==(a=null===(l=s.marks)||void 0===l?void 0:l.filter(function(e){return e.type!==n1}))&&void 0!==a?a:[],u=void 0,d=0;null!=(u=n0.exec(s.text));){var p=u.index,f=p+u[0].length;if(p>d){var m={type:"text",text:s.text.substring(d,p)};null!=c&&c.length&&(m.marks=c),i.push(m)}i.push({type:"text",text:s.text.substring(p,f),marks:[].concat((0,k.Z)(c),[{type:n1,attrs:{timestamp:s.text.substring(p,f)}}])}),d=f}if(d<s.text.length){var v={type:"text",text:s.text.substring(d)};null!=c&&c.length&&(v.marks=c),i.push(v)}}}catch(e){o.e(e)}finally{o.f()}n.content=i}})}var n9=Z.ZP.div.withConfig({displayName:"styled__ResourceWrapper",componentId:"sc-1wq200d-0"})(["display:flex;align-items:center;&:not(:last-child){","}> div{cursor:pointer;display:flex;align-items:center;&:hover{text-decoration:underline;text-decoration-color:",";}}a{text-decoration:none;display:flex;align-items:center;&:hover{text-decoration:underline;text-decoration-color:",";}}"],function(e){return!e.$editing&&"margin-bottom: 16px;"},T.O9.secondary,T.O9.secondary),n6=(0,Z.ZP)(ec.h_).withConfig({displayName:"styled__ResourceDropdownMenu",componentId:"sc-1wq200d-1"})(["display:flex;visibility:hidden;align-items:center;margin-left:8px;height:40px;",":hover &{visibility:visible;}",""],n9,function(e){var n=e.theme,t=e.$forceDropdownVisible;return(n.isMobile||t)&&"visibility: visible;"}),n7=Z.ZP.div.withConfig({displayName:"styled__ResourceIconWrapper",componentId:"sc-1wq200d-2"})(["color:",";> div{width:24px;height:24px;}"],T.O9.n5),n8=Z.ZP.span.withConfig({displayName:"styled__ResourceLabel",componentId:"sc-1wq200d-3"})(["color:",";margin-left:8px;",";"],T.O9.secondary,_.c.t7),te=t(320),tn=(0,u.memo)(function(e){var n=e.resource,t=e.editing,r=e.canMoveUp,i=e.canMoveDown,o=e.onEdit,l=e.onMoveUp,s=e.onMoveDown,f=e.onDelete,m=e.onAttachmentPreview,v=(0,u.useState)(!1),b=v[0],g=v[1],x=(0,d.bI)("isMobile"),y=x.isMobile,w=x.dispatch,k=(0,j.useRouter)(),I=n.title,M=n.fileName,P=n.fileContentType,O=n.link,Z=n.fileId,_=(0,u.useCallback)(function(){g(!0)},[]),T=(0,u.useCallback)(function(){g(!1)},[]),D=(0,u.useMemo)(function(){return t?(0,S.jsx)(n6,{active:!0,variant:"icon-borderless",icon:"HorizontalDots",$forceDropdownVisible:b,onShow:_,onHide:T,options:[{label:"Edit",onClick:function(){return null==o?void 0:o(n)}},{label:"Move up",onClick:function(){return null==l?void 0:l(n)},disabled:!r},{label:"Move down",onClick:function(){return null==s?void 0:s(n)},disabled:!i},{label:"Delete",onClick:function(){return null==f?void 0:f(n)}}]}):null},[i,r,t,f,o,s,l,n,b,_,T]),E=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var t,r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(y&&"application/pdf"===P)){e.next=12;break}if(t=window.open("","_blank")){e.next=5;break}return w(p.bI,{message:"Failed to open file",severity:"error"}),e.abrupt("return");case 5:return e.next=7,h.Z.getResourceUrl({fileId:Z});case 7:r=e.sent.data,t.location=r,e.next=13;break;case 12:m(n);case 13:case"end":return e.stop()}},e)})),[P,Z,y,m,n,w]),N=(0,u.useCallback)(function(){(0,J.H5)(k)},[k]);return O?(0,S.jsxs)(n9,{$editing:t,children:[(0,S.jsxs)("a",{href:O,rel:"noreferrer",target:"_blank",children:[(0,S.jsx)(n7,{children:(0,S.jsx)(C.J,{name:"LinkBox"})}),(0,S.jsx)(n8,{children:I})]}),D]}):(0,S.jsx)(e6.Z,{reason:G.lT.ClassroomInteraction,onSuccess:E,onPending:N,children:function(e){var n=e.onClick;return(0,S.jsxs)(n9,{$editing:t,children:[(0,S.jsxs)("div",{onClick:n,children:[(0,S.jsx)(te.a,{fileName:M,contentType:P,size:24}),(0,S.jsx)(n8,{children:I})]}),D]})}})}),tt=t(74109),tr=(0,Z.iv)(["visibility:inherit;right:4px;top:4px;"]),ti=(0,Z.ZP)(en.z).withConfig({displayName:"styled__RemoveVideoButton",componentId:"sc-c9r8op-0"})(["position:absolute;right:8px;top:8px;z-index:2;visibility:hidden;> div{width:16px !important;height:16px !important;}",""],function(e){return e.theme.isMobile&&tr}),to=(0,Z.ZP)(ti).withConfig({displayName:"styled__CopyVideoUrlButton",componentId:"sc-c9r8op-1"})(["right:","px;"],function(e){return e.theme.isMobile?48:56}),ta=(0,Z.iv)(["border-top:0px;border:0px;video{border-top-right-radius:0px;border-top-left-radius:0px;}iframe{border-top-right-radius:0px;border-top-left-radius:0px;}"]),tl=Z.ZP.div.withConfig({displayName:"styled__VideoWrapper",componentId:"sc-c9r8op-2"})(["width:100%;z-index:1;display:flex;overflow:hidden;border-bottom:0px;background:",";border-radius:10px;position:relative;margin:16px 0 8px;.wistia_embed{height:100% !important;width:100% !important;}&:hover ",",&:hover ","{visibility:inherit;}",""],T.O9.n1,ti,to,function(e){return e.isMobile&&ta}),ts=(0,Z.iv)(["border-top-left-radius:10px;border-top-right-radius:10px;overflow:hidden;"]),tc=Z.ZP.div.withConfig({displayName:"styled__VideoThumbnail",componentId:"sc-c9r8op-3"})(["position:relative;padding-top:56.25%;height:0;width:100%;background-position:center center;background-size:cover;background-repeat:no-repeat;z-index:2;"," opacity:1;",""],function(e){var n=e.$thumbnailUrl;return n&&'background-image: url("'.concat(n,'");')},function(e){return!e.theme.isMobile&&ts}),tu=Z.ZP.div.withConfig({displayName:"styled__VideoThumbnailContent",componentId:"sc-c9r8op-4"})(["position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;background-color:rgba(0,0,0,0.5);color:",";"," ",""],T.O9.n1,function(e){return e.theme.isMobile?_.c.t5:_.c.t2},function(e){return e.theme.isDarkTheme&&"color: ".concat(T.O9.n7,";")}),td=Z.ZP.div.withConfig({displayName:"styled__LockedEmpty",componentId:"sc-c9r8op-5"})(["position:relative;padding-top:56.25%;height:0;width:100%;background-color:",";z-index:2;opacity:1;",""],T.O9.n7,function(e){return!e.theme.isMobile&&ts}),tp=(0,Z.ZP)(C.J).withConfig({displayName:"styled__ContentLockedIcon",componentId:"sc-c9r8op-6"})(["width:34px;height:34px;"]),tf=t(97059),tm=t(99802),tv=(0,u.memo)(function(e){var n,t,r,i,o,a,l=e.course,s=e.module,c=e.startTime,f=e.refreshStartTime,m=e.editing,v=e.videoDataOverride,h=e.onDeleteVideoClick,b=(0,d.bI)("isMobile","self"),g=b.isMobile,y=b.self,C=b.dispatch,w=(0,u.useState)(!1),k=w[0],j=w[1],I=(0,u.useRef)(),M=s.metadata,P=M.dripDays,O=M.hasAccess,Z=null!=v?v:s.metadata,_=Z.videoLink,T=Z.videoThumbnail,D=Z.videoLenMs,E=Z.videoStream,N=T?(0,e9.UO)(T):null,L=(0,u.useMemo)(function(){return{borderTopRightRadius:g?0:10,borderTopLeftRadius:g?0:10,overflow:"hidden"}},[g]),A=(0,u.useCallback)(function(){navigator.clipboard.writeText(_),I.current&&clearTimeout(I.current),C(p.bI,{message:"Video link copied"}),j(!0),I.current=setTimeout(function(){I.current=null,j(!1)},1500)},[_,C]);if(O)return _?(0,S.jsxs)(tl,{children:[(0,S.jsx)(tt.Z,{url:_,thumbnailUrl:T,duration:D,startTime:c,refreshStartTime:f,streamURL:E,playDisabled:m,style:L}),m&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(to,{icon:k?"Done":"Link",variant:"icon",onClick:A}),(0,S.jsx)(ti,{icon:"Close",variant:"icon",onClick:h})]})]}):null;var R=null==l||null===(n=l.metadata)||void 0===n?void 0:n.privacy,z=null==l||null===(t=l.metadata)||void 0===t?void 0:t.minAccessLevel,F=l.amount,$=l.currency,H=(null==y||null===(r=y.member)||void 0===r?void 0:r.role)!=="pending"&&(null==y||null===(i=y.member)||void 0===i?void 0:i.role)!=="declined"&&y&&(null===(o=(0,tf._)(y))||void 0===o?void 0:o.level)||0;if(P)a="Page unlocks in ".concat(x()("day",P,!0));else if(2===R&&H<z)a="Course unlocks at Level ".concat(z);else if(3==R&&F&&$){var B=(0,tm.O5)({amount:F,currency:$,showZeroes:!1});a="Unlock for ".concat(B)}else a="You don't have access to this course";return N?(0,S.jsx)(tl,{children:(0,S.jsx)(tc,{$thumbnailUrl:N,children:(0,S.jsxs)(tu,{children:[(0,S.jsx)(tp,{name:P?"Clock":"Lock"}),a]})})}):(0,S.jsx)(tl,{children:(0,S.jsx)(td,{children:(0,S.jsxs)(tu,{children:[(0,S.jsx)(tp,{name:P?"Clock":"Lock"}),a]})})})}),th=t(66703),tb=(0,Z.iv)(["padding:16px 13px;"]),tg=Z.ZP.div.withConfig({displayName:"styled__CourseModuleWrapper",componentId:"sc-cgnv0g-0"})(["justify-content:space-between;align-items:flex-start;padding:32px;width:100%;",""],function(e){return e.theme.isMobile&&tb}),tx=(0,Z.iv)(["width:100%;",""],_.c.t2),ty=Z.ZP.div.withConfig({displayName:"styled__ModuleTitle",componentId:"sc-cgnv0g-1"})(["overflow:hidden;text-overflow:ellipsis;flex:1;"," ",""],_.c.t1,function(e){return e.theme.isMobile&&tx}),tC=Z.ZP.div.withConfig({displayName:"styled__ModuleTitleRow",componentId:"sc-cgnv0g-2"})(["display:flex;justify-content:space-between;align-items:center;"]),tw=Z.ZP.div.withConfig({displayName:"styled__ModuleBody",componentId:"sc-cgnv0g-3"})(["display:flex;flex-direction:column;"]),tk=Z.ZP.div.withConfig({displayName:"styled__ModuleFooter",componentId:"sc-cgnv0g-4"})(["width:100%;padding-top:32px;"]),tj=(0,Z.ZP)(en.z).withConfig({displayName:"styled__LearnMoreButton",componentId:"sc-cgnv0g-5"})(["width:100%;"]),tI=Z.ZP.div.withConfig({displayName:"styled__ModuleSectionHeader",componentId:"sc-cgnv0g-6"})(["margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;width:100%;",""],_.c.t5),tM=Z.ZP.div.withConfig({displayName:"styled__ModuleSection",componentId:"sc-cgnv0g-7"})(["margin-top:32px;"]),tP=Z.ZP.div.withConfig({displayName:"styled__TranscriptBody",componentId:"sc-cgnv0g-8"})(["white-space:break-spaces;",";"],_.c.t7),tS=Z.ZP.div.withConfig({displayName:"styled__TranscriptExpandToggle",componentId:"sc-cgnv0g-9"})(["color:",";cursor:pointer;",";"],T.O9.secondary,_.c.t7),tO=(0,Z.ZP)(en.z).withConfig({displayName:"styled__ModuleCompletionButton",componentId:"sc-cgnv0g-10"})([""," &:hover{"," ","}"],function(e){var n=e.$completed;return"color: ".concat(n?T.O9.success:T.O9.n5,";")},function(e){var n=e.$completed;return"color: ".concat(n?T.O9.success:T.O9.n7,";")},function(e){return e.theme.isMobile&&"background-color: ".concat(T.O9.n1)}),tZ=(0,Z.ZP)(th.u).withConfig({displayName:"styled__ModuleCompletionTooltip",componentId:"sc-cgnv0g-11"})(["display:inline-block;"]),t_=Z.ZP.div.withConfig({displayName:"styled__NavRow",componentId:"sc-cgnv0g-12"})(["display:flex;width:100%;align-items:center;justify-content:space-between;margin-top:",";padding:0 8px;color:",";",";> a{display:flex;gap:6px;align-items:center;}"],function(e){return e.$hasVideo?"2px":"16px"},T.O9.secondary,_.c.t11),tT=(0,Z.iv)(["margin-bottom:24px;"]),tD=Z.ZP.div.withConfig({displayName:"styled__PinnedPostsWrapper",componentId:"sc-cgnv0g-13"})(["margin-top:32px;",""],function(e){return e.theme.isMobile&&tT}),tE=t(21877);function tN(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function tL(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?tN(Object(t),!0).forEach(function(n){(0,l.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tN(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function tA(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return tR(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return tR(e,n)}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(l)throw o}}}}function tR(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var tz=(0,u.memo)(function(e){var n,t,r,i,o=e.course,l=e.courseChildren,s=e.module,f=e.resources,m=e.startTime,v=e.setStartTime,b=e.onAttachmentPreview,g=e.onStartEditing,x=e.onPostDragEnd,k=e.onRemovePost,j=e.pinnedPosts,I=(0,d.bI)("currentGroup","completedModules","self","isMobile"),M=I.currentGroup,P=I.completedModules,Z=I.self,_=I.isMobile,T=I.dispatch,D=(0,u.useState)(!1),E=D[0],N=D[1],L=(0,u.useState)(null!==(n=null==s||null===(t=s.metadata)||void 0===t?void 0:t.completed)&&void 0!==n&&n),A=L[0],R=L[1],z=(0,u.useState)(0),F=z[0],$=z[1],H=null!==(r=null==s?void 0:s.metadata)&&void 0!==r?r:{},B=H.title,U=H.desc,V=H.transcript,W=H.hasAccess,q=H.videoLink,J=2===s.state,Y=(null!==(i=null==V?void 0:V.length)&&void 0!==i?i:0)>300,X=(0,G.CP)({user:Z,member:null==Z?void 0:Z.member,group:M}),K=(0,y.rE)({group:M,course:o,courseModule:"menu"}),Q=(0,u.useMemo)(function(){return!!q&&(0,e9.ak)(q).provider!==e9.a.Loom},[q]),ee=(0,u.useMemo)(function(){if(!U)return null;var e=n3(U);return n5(e),e},[U]),et=(0,u.useMemo)(function(){if(!ee||0===ee.length)return!0;var e=ee[0],n=e.type,t=e.content;return 1===ee.length&&("heading"===n||"paragraph"===n)&&!t},[ee]),er=(0,u.useMemo)(function(){return V?"".concat(V.slice(0,300),"..."):""},[V]),ei=(0,u.useMemo)(function(){var e;return null!==(e=null==f?void 0:f.filter(function(e){return!e.link}))&&void 0!==e?e:[]},[f]),eo=(0,u.useMemo)(function(){if(!_)return null;var e=function(e,n){var t,r=!1,i=tA(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=o.course,l=o.children;if("module"===a.unitType){if(r)return a;a.id===n&&(r=!0)}if(l){var s,c=tA(l);try{for(c.s();!(s=c.n()).done;){var u=s.value.course;if(r)return u;u.id===n&&(r=!0)}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){i.e(e)}finally{i.f()}return null}(l,s.id);return e?(0,y.rE)({group:M,course:o,courseModule:e.id}):null},[l,null==s?void 0:s.id,M,o,_]),ea=(0,u.useMemo)(function(){return null!=j&&j.length?(0,S.jsx)(tD,{children:(0,S.jsx)(nY.Z,{postTrees:j,group:M,showStats:!0,draggable:X&&!_,onDragEnd:x,onRemovePost:X?k:void 0})}):null},[j,M,_,X,x,k]),el=(0,u.useCallback)(function(e){b({initialIdx:ei.findIndex(function(n){return n.fileId===e.fileId}),fileResources:ei})},[b,ei]),es=(0,u.useCallback)(function(){N(!E)},[E]),ec=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.markCourseDone({courseId:s.id});case 2:R(!0),(n=tL({},P))[s.id]=!0,T(p.Io,n);case 6:case"end":return e.stop()}},e)})),[P,T,null==s?void 0:s.id]),eu=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.markCourseUndone({courseId:s.id});case 2:R(!1),(n=tL({},P))[s.id]=!1,T(p.Io,n);case 6:case"end":return e.stop()}},e)})),[P,T,null==s?void 0:s.id]),ed=(0,u.useCallback)(function(e){var n,t=e.split(":");(n=3===t.length?3600*parseInt(t[0])+60*parseInt(t[1])+parseInt(t[2]):60*parseInt(t[0])+parseInt(t[1]))===m?$(function(e){return e+1}):v(n)},[v,m]),ep=(0,u.useMemo)(function(){return(0,G.cD)({member:null==Z?void 0:Z.member,group:M})},[Z,M]),ef=Z&&W&&J&&(0,S.jsx)(e6.Z,{reason:G.lT.ClassroomInteraction,onSuccess:A?eu:ec,children:function(e){var n=e.onClick;return(0,S.jsx)(tZ,{content:A?"Mark as incomplete":"Mark as done",placement:"top",children:(0,S.jsx)(tO,{onClick:n,icon:A?"CheckCircle":"CheckCircleAlt",iconSize:_?20:24,variant:"icon-borderless",$completed:A})},A)}});O({course:o,onStartEditing:X?g:void 0,searchOverride:ef});var em=(null==o?void 0:o.metadata).hasAccess,ev=(0,u.useCallback)(function(){T(p.x0,{group:M,course:o})},[T,o,M]),eh=(0,u.useMemo)(function(){return Z&&ep?(0,S.jsx)(tj,{variant:"primary",label:"Learn More",onClick:ev}):(0,S.jsx)(tE.F,{joinLabel:"LEARN MORE",autoJoin:!1})},[Z,ep,ev]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(tg,{children:[(0,S.jsxs)(tC,{children:[(0,S.jsx)(ty,{title:B,children:B}),!_&&(0,S.jsxs)(nr.X,{children:[ef,X&&(0,S.jsx)(en.z,{onClick:g,icon:"Edit",variant:"icon-borderless"})]})]}),(0,S.jsxs)(tw,{children:[(0,S.jsx)(tv,{course:o,module:s,startTime:m,refreshStartTime:F}),_&&(0,S.jsxs)(t_,{$hasVideo:q,children:[(0,S.jsxs)(w.r,{href:K.as,children:[(0,S.jsx)(C.J,{name:"Left",size:10}),"Menu"]}),eo&&(0,S.jsxs)(w.r,{href:eo.as,children:["Next",(0,S.jsx)(C.J,{name:"Right",size:10})]})]}),ee&&!et&&(0,S.jsx)(nJ,{initialContent:ee,onVideoTimestampClick:Q?ed:void 0,readOnly:!0}),!!(null!=f&&f.length)&&(0,S.jsxs)(tM,{children:[(0,S.jsx)(tI,{children:"Resources"}),f.map(function(e,n){return(0,S.jsx)(tn,{resource:e,onAttachmentPreview:el},n)})]}),V&&(0,S.jsxs)(tM,{children:[(0,S.jsxs)(tI,{children:["Transcript",Y&&(0,S.jsx)(tS,{onClick:es,children:E?"Collapse":"Expand"})]}),(0,S.jsx)(tP,{children:Y&&!E?er:V})]}),!_&&ea]}),!em&&(0,S.jsx)(tk,{children:eh})]}),_&&ea]})}),tF=t(96486),t$=(0,Z.ZP)(Q.fe).withConfig({displayName:"styled__AddVideoModalBody",componentId:"sc-14rpick-0"})(["display:flex;flex-direction:column;gap:16px;"]);function tH(e,n){return tB.apply(this,arguments)}function tB(){return(tB=(0,a.Z)(c().mark(function e(n,t){var r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((0,e9.ak)(n).videoID){e.next=3;break}return e.abrupt("return",void 0);case 3:return e.next=5,h.Z.getVideoMeta({url:n,width:1280});case 5:if(!(r=e.sent.data)){e.next=11;break}return e.abrupt("return",r);case 11:if(!t){e.next=17;break}return e.next=14,new Promise(function(e){return setTimeout(e,1e3)});case 14:return e.next=16,tH(n,t-1);case 16:return e.abrupt("return",e.sent);case 17:return e.abrupt("return",void 0);case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}function tU(){return(tU=(0,a.Z)(c().mark(function e(n){var t,r,i,o,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.thumbnail){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,fetch(n.thumbnail);case 4:return t=e.sent,e.next=7,t.blob();case 7:return r=e.sent,e.next=10,h.Z.createFile({fileName:"vimeo_thumbnail_".concat(n.videoId),contentLength:r.size,contentType:r.type,ownerID:self.id});case 10:if(o=(i=e.sent).data,!i.error){e.next=15;break}return e.abrupt("return",null);case 15:return e.prev=15,e.next=18,(0,e8.cT)({fileID:o.file.id,writeUrl:o.writeUrl,contentType:o.contentType,acl:o.acl,data:r,timeout:6e4});case 18:if(!(a=e.sent)){e.next=21;break}return e.abrupt("return",a.metadata.readUrl);case 21:e.next=26;break;case 23:return e.prev=23,e.t0=e.catch(15),e.abrupt("return",null);case 26:case"end":return e.stop()}},e,null,[[15,23]])}))).apply(this,arguments)}var tV=(0,u.memo)(function(e){var n=e.open,t=e.onSubmit,r=e.onClose,i=(0,u.useState)(""),o=i[0],l=i[1],s=(0,u.useState)(""),p=s[0],f=s[1],m=(0,u.useState)(!1),v=m[0],h=m[1],b=(0,d.bI)("isMobile").isMobile,g=(0,u.useCallback)(function(e){l(e.target.value)},[]),x=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var n,r,i,a,l,s,u;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),n=(0,y.X2)(o),e.next=4,tH(n,2);case 4:if(r=e.sent,i=(0,e9.ak)(n),r){e.next=11;break}return h(!1),(null==i?void 0:i.provider)!==2&&f("Invalid video link"),(null==i?void 0:i.provider)===2&&f("Invalid video link. If this was a recent upload to Vimeo, or you recently changed your privacy settings, please wait 5 minutes and try again."),e.abrupt("return");case 11:if(a=r.lenMs,l=r.stream,s=r.thumbnail,(null==i?void 0:i.provider)!==e9.a.Vimeo){e.next=19;break}return e.next=17,function(e){return tU.apply(this,arguments)}(r);case 17:(u=e.sent)&&(s=u);case 19:h(!1),t({videoLink:n,videoThumbnail:s,videoLenMs:a,videoStream:l});case 21:case"end":return e.stop()}},e)})),[t,o]);return(0,S.jsx)(eu.T,{open:n,header:"Add a video",confirmLabel:"Add",onConfirm:x,onCancel:r,onClose:r,cancelButtonVariant:b?"secondary":"borderless",disabled:!o,loading:v,children:(0,S.jsxs)(t$,{children:["Add a YouTube, Vimeo, Loom, or Wistia video link.",(0,S.jsx)(ee.I,{autoFocus:!0,staticLabel:!0,placeholder:"Link",value:o,onChange:g,error:p,inputProps:{"data-testid":"add-video-input"}})]})})}),tW=(0,Z.ZP)(Q.fe).withConfig({displayName:"styled__AddResourceLinkModalBody",componentId:"sc-s1ij5f-0"})(["display:flex;flex-direction:column;gap:16px;"]),tG=(0,u.memo)(function(e){var n=e.open,t=e.onSubmit,r=e.onClose,i=(0,u.useState)(""),o=i[0],l=i[1],s=(0,u.useState)(""),p=s[0],f=s[1],m=(0,u.useState)(""),v=m[0],h=m[1],b=(0,d.bI)("isMobile").isMobile,g=(0,u.useCallback)(function(e){l(e.target.value)},[]),x=(0,u.useCallback)(function(e){f(e.target.value)},[]),C=(0,u.useCallback)((0,a.Z)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((0,q.K2)(p)){e.next=3;break}return h("Please input a valid link"),e.abrupt("return");case 3:t({title:o.trim(),link:(0,y.X2)(p)});case 4:case"end":return e.stop()}},e)})),[t,o,p]);return(0,S.jsx)(eu.T,{open:n,header:"Add link",confirmLabel:"Add",onConfirm:C,onCancel:r,onClose:r,cancelButtonVariant:b?"secondary":"borderless",disabled:!o.trim()||o.length>34||!p,children:(0,S.jsxs)(tW,{children:[(0,S.jsx)(ee.I,{label:"Label",value:o,maxCharacters:34,onChange:g}),(0,S.jsx)(ee.I,{label:"URL",value:p,onChange:x,error:v})]})})}),tq=(0,Z.ZP)(Q.fe).withConfig({displayName:"styled__AddResourceFileModalBody",componentId:"sc-wkqneg-0"})(["display:flex;flex-direction:column;gap:32px;min-width:0;"]),tJ=Z.ZP.div.withConfig({displayName:"styled__FileResourceWrapper",componentId:"sc-wkqneg-1"})(["display:flex;gap:8px;"," > div:last-child{","}"],_.c.t5,_.c.ellipsis),tY=Z.ZP.div.withConfig({displayName:"styled__UploadError",componentId:"sc-wkqneg-2"})(["color:",";"],T.O9.error),tX=(0,u.memo)(function(e){var n=e.open,t=e.uploading,r=e.file,i=e.error,o=e.onSubmit,l=e.onClose,s=(0,u.useState)(""),p=s[0],f=s[1],m=(0,d.bI)("isMobile").isMobile,v=(0,u.useCallback)(function(e){f(e.target.value)},[]),h=(0,u.useCallback)((0,a.Z)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o({title:p.trim(),fileId:r.id,fileName:r.metadata.fileName,fileContentType:r.metadata.contentType});case 1:case"end":return e.stop()}},e)})),[o,p,r]),b=(0,u.useMemo)(function(){return i?(0,S.jsx)(tY,{children:i}):t?(0,S.jsxs)(tJ,{children:[(0,S.jsx)(eg.D,{}),"Uploading..."]}):(0,S.jsxs)(tJ,{children:[(0,S.jsx)(te.a,{fileName:null==r?void 0:r.metadata.fileName,contentType:null==r?void 0:r.metadata.contentType,size:24}),(0,S.jsx)("div",{children:null==r?void 0:r.metadata.fileName})]})},[i,t,r]);return(0,S.jsx)(eu.T,{open:n,header:"Add file",confirmLabel:"Add",onConfirm:h,onCancel:l,cancelButtonVariant:m?"secondary":"borderless",disabled:!p.trim()||p.length>34||t||!!i,children:(0,S.jsxs)(tq,{children:[b,(0,S.jsx)(ee.I,{label:"Label",value:p,maxCharacters:34,onChange:v})]})})}),tK=Z.ZP.div.withConfig({displayName:"styled__EditResourceModalBody",componentId:"sc-15xygpc-0"})(["display:flex;flex-direction:column;gap:32px;"]),tQ=Z.ZP.div.withConfig({displayName:"styled__FileResourceWrapper",componentId:"sc-15xygpc-1"})(["display:flex;gap:8px;"]),t0=(0,u.memo)(function(e){var n=e.open,t=e.resource,r=e.onSubmit,i=e.onClose,o=(0,u.useState)(t.title),a=o[0],l=o[1],s=(0,u.useState)(t.link),c=s[0],p=s[1],f=(0,u.useState)(""),m=f[0],v=f[1],h=(0,d.bI)("isMobile").isMobile,b=(0,u.useCallback)(function(e){l(e.target.value)},[]),g=(0,u.useCallback)(function(e){v(""),p(e.target.value)},[]),x=(0,u.useCallback)(function(){if(t.link&&!(0,q.K2)(c)){v("Please input a valid link");return}r({title:a.trim(),link:(0,y.X2)(c)})},[r,a,c,t.link]),C=(0,u.useMemo)(function(){var e=a.trim();return!e||a.length>34||!!t.link&&!c||e===t.title&&c===t.link},[t,a,c]);return(0,S.jsx)(eu.T,{open:n,header:t.link?"Edit link":"Edit file",confirmLabel:"Save",cancelButtonVariant:h?"secondary":"borderless",disabled:C,onConfirm:x,onCancel:i,onClose:i,children:(0,S.jsxs)(tK,{children:[!t.link&&(0,S.jsxs)(tQ,{children:[(0,S.jsx)(te.a,{fileName:t.fileName,contentType:t.contentType,size:24}),t.title]}),(0,S.jsx)(ee.I,{label:"Label",value:a,onChange:b,maxCharacters:34}),t.link&&(0,S.jsx)(ee.I,{label:"URL",value:c,onChange:g,error:m})]})})}),t1=(0,Z.iv)(["padding-bottom:24px;> div{border:none;border-radius:0;}> div > div:first-child{border-radius:0;}"]),t2=Z.ZP.div.withConfig({displayName:"styled__CourseModuleWrapper",componentId:"sc-19bc6jm-0"})(["width:100%;",""],function(e){return e.theme.isMobile&&t1}),t3=Z.ZP.div.withConfig({displayName:"styled__ModuleSectionHeader",componentId:"sc-19bc6jm-1"})(["margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;width:100%;",""],_.c.t5),t4=Z.ZP.div.withConfig({displayName:"styled__ModuleTitle",componentId:"sc-19bc6jm-2"})(["margin-top:",";"],function(e){return e.theme.isMobile?"11px":"0"}),t5=(0,Z.iv)(["height:40px;",";&::placeholder{",";}"],_.c.t2,_.c.t2),t9=(0,Z.iv)(["visibility:visible;"]),t6=(0,Z.ZP)(ee.I).withConfig({displayName:"styled__ModuleTitleInput",componentId:"sc-19bc6jm-3"})(["padding:0;margin:0;min-height:auto;input{height:35px;padding:0;",";&::placeholder{color:",";opacity:0.8;",";}",';}&::after{content:"";display:block;position:absolute;bottom:0;left:0;right:0;height:2px;background:',";visibility:hidden;",";}"],_.c.t1,T.O9.n5,_.c.t1,function(e){return e.theme.isMobile&&t5},T.O9.e2,function(e){return e.$hasError&&t9}),t7=(0,Z.ZP)(t3).withConfig({displayName:"styled__ResourcesSectionHeader",componentId:"sc-19bc6jm-4"})(["margin-bottom:8px;"]),t8=Z.ZP.div.withConfig({displayName:"styled__ResourcesSection",componentId:"sc-19bc6jm-5"})(["margin-bottom:32px;"]),re=Z.ZP.div.withConfig({displayName:"styled__TranscriptSection",componentId:"sc-19bc6jm-6"})(["margin-bottom:32px;"]),rn=(0,Z.iv)(["flex-direction:column-reverse;align-items:center;width:100%;margin-top:24px;gap:8px;"]),rt=Z.ZP.div.withConfig({displayName:"styled__FooterButtonGroup",componentId:"sc-19bc6jm-7"})(["display:flex;flex-direction:row;align-items:center;",""],function(e){return e.theme.isMobile&&rn}),rr=Z.ZP.div.withConfig({displayName:"styled__FooterActionGroup",componentId:"sc-19bc6jm-8"})(["display:flex;flex-direction:row;justify-content:space-between;align-items:center;gap:24px;"]),ri=(0,Z.iv)(["display:flex;justify-content:space-between;align-items:center;"]),ro=Z.ZP.div.withConfig({displayName:"styled__Footer",componentId:"sc-19bc6jm-9"})(["",""],function(e){return!e.theme.isMobile&&ri}),ra=Z.ZP.div.withConfig({displayName:"styled__ErrorText",componentId:"sc-19bc6jm-10"})(["color:",";margin-bottom:16px;display:flex;justify-content:flex-end;",""],T.O9.error,_.c.t9),rl=(0,Z.ZP)(ec.h_).withConfig({displayName:"styled__ActionDropdownMenu",componentId:"sc-19bc6jm-11"})(["height:unset;button{height:48px;gap:4px;",";","}"],_.c.t5,function(e){return e.theme.isDarkTheme&&"color: ".concat(T.O9.n5)}),rs=(0,Z.iv)(["margin-top:16px;margin-bottom:8px;"]),rc=Z.ZP.div.withConfig({displayName:"styled__PinnedPostsWrapper",componentId:"sc-19bc6jm-12"})(["margin-top:24px;",""],function(e){return e.theme.isMobile&&rs});function ru(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function rd(e){if(!e||0===e.length)return!0;var n=e[0],t=n.type,r=n.content;return 1===e.length&&("heading"===t||"paragraph"===t)&&!r}var rp=(0,u.memo)(function(e){var n,t,r,i,o,s,f,m,v,b,g,x,y,C,w,M,P,Z,_,T,D,E,N,L,A,R,z,F,$,H=e.course,B=e.module,U=e.resources,W=e.onStopEditing,G=e.onAttachmentPreview,q=e.onPostDragEnd,X=e.onRemovePost,K=e.pinnedPosts,Q=(t=B.state,r=B.metadata,o=(i=(0,u.useState)(null!==(n=null==r?void 0:r.title)&&void 0!==n?n:""))[0],s=i[1],m=(f=(0,u.useState)((null==r?void 0:r.transcript)||null))[0],v=f[1],g=(b=(0,u.useState)(2===t))[0],x=b[1],C=(y=(0,u.useState)(null!=U?U:null))[0],w=y[1],M=(0,u.useMemo)(function(){return{videoLink:r.videoLink,videoThumbnail:r.videoThumbnail,videoLenMs:r.videoLenMs,videoStream:r.videoStream}},[r]),Z=(P=(0,u.useState)(M))[0],_=P[1],T=(0,u.useMemo)(function(){if(!(null!=r&&r.desc))return null;var e=n3(r.desc);return n5(e),e},[null==r?void 0:r.desc]),E=(D=(0,u.useState)(T))[0],N=D[1],L=(0,u.useCallback)(function(e){s(e.target.value)},[]),A=(0,u.useCallback)(function(e){N(e)},[]),R=(0,u.useCallback)(function(e){v(e.target.value)},[]),z=(0,u.useCallback)(function(){x(!g)},[g]),F=(0,u.useCallback)(function(e){_(e)},[]),(0,u.useMemo)(function(){return{title:o,handleTitleChange:L,initialDescription:T,description:E,handleDescriptionChange:A,transcript:m,handleTranscriptChange:R,published:g,handleTogglePublished:z,videoData:Z,handleVideoDataChange:F,resources:C,handleResourcesChange:w}},[o,L,T,E,A,m,R,g,z,Z,F,C,w])),et=Q.title,ei=Q.handleTitleChange,eo=Q.initialDescription,ea=Q.description,el=Q.handleDescriptionChange,es=Q.transcript,ec=Q.handleTranscriptChange,ed=Q.published,ep=Q.handleTogglePublished,ef=Q.videoData,em=Q.handleVideoDataChange,ev=Q.resources,eh=Q.handleResourcesChange,eb=(0,Y.C1)(),eg=(0,V.Z)(eb,3),ex=eg[0],ey=eg[1],eC=eg[2],ew=(0,Y.C1)(),ek=(0,V.Z)(ew,3),ej=ek[0],eI=ek[1],eM=ek[2],eP=(0,Y.C1)(),eS=(0,V.Z)(eP,3),eO=eS[0],eZ=eS[1],e_=eS[2],eT=(0,Y.C1)(),eD=(0,V.Z)(eT,4),eE=eD[0],eN=eD[1],eL=eD[2],eA=eD[3],eR=(0,Y.C1)(),ez=(0,V.Z)(eR,4),eF=ez[0],e$=ez[1],eH=ez[2],eB=ez[3],eU=(0,Y.C1)(),eV=(0,V.Z)(eU,4),eW=eV[0],eG=eV[1],eq=eV[2],eJ=eV[3],eY=(0,Y.C1)(),eX=(0,V.Z)(eY,3),eK=eX[0],eQ=eX[1],e0=eX[2],e1=(0,u.useState)(!1),e2=e1[0],e3=e1[1],e4=(0,u.useState)(!1),e5=e4[0],e9=e4[1],e6=(0,u.useState)(""),e7=e6[0],ne=e6[1],nn=(0,u.useState)(!1),nt=nn[0],nr=nn[1],ni=(0,u.useState)(""),no=ni[0],na=ni[1],nl=(0,u.useRef)(),ns=(0,u.useRef)(),nc=(0,u.useRef)(),nu=(0,d.bI)("currentGroup","isMobile","self"),nd=nu.currentGroup,np=nu.isMobile,nf=nu.self,nm=nu.dispatch,nv=(0,j.useRouter)();O({course:H});var nh=(0,u.useMemo)(function(){var e;return null!==(e=null==ev?void 0:ev.filter(function(e){return!e.link}))&&void 0!==e?e:[]},[ev]),nb=(0,u.useCallback)(function(e){G({initialIdx:nh.findIndex(function(n){return n.fileId===e.fileId}),fileResources:nh})},[G,nh]),ng=(0,u.useCallback)(function(e){em(e),eC(),nm(p.bI,{message:"Video added"})},[eC,em,nm]),nx=(0,u.useCallback)(function(){e3(!0)},[]),ny=(0,u.useCallback)(function(){e3(!1)},[]),nC=(0,u.useCallback)(function(){em({videoLink:"",videoThumbnail:""}),eM()},[eM,em]),nw=(0,u.useCallback)(function(e){var n=(0,k.Z)(ev),t=n.indexOf(e),r=n[t-1];n[t-1]=e,n[t]=r,eh(n)},[eh,ev]),nk=(0,u.useCallback)(function(e){var n=(0,k.Z)(ev),t=n.indexOf(e),r=n[t+1];n[t+1]=e,n[t]=r,eh(n)},[eh,ev]),nj=(0,u.useCallback)(function(e){eh([].concat((0,k.Z)(ev),[e])),eL(),nm(p.bI,{message:"File added"})},[ev,eh,eL,nm]),nI=(0,u.useCallback)(function(e){eh([].concat((0,k.Z)(ev),[e])),e_(),nm(p.bI,{message:"Link added"})},[ev,eh,e_,nm]),nM=(0,u.useCallback)(function(e){var n=(0,k.Z)(ev),t=n.indexOf(eB),r=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ru(Object(t),!0).forEach(function(n){(0,l.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ru(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},n[t]);r.title=e.title,eB.link&&(r.link=e.link),n[t]=r,eh(n),eH()},[ev,eB,eh,eH]),nP=(0,u.useCallback)(function(){var e=(0,k.Z)(ev),n=e.indexOf(eJ);e.splice(n,1),eh(e),eq()},[ev,eJ,eh,eq]),nS=(0,u.useCallback)(($=(0,a.Z)(c().mark(function e(n){var t,r,i,o,a,l,s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e9(!0),ne(""),eN(),t=n.target.files[0],e.next=6,h.Z.createFile({fileName:t.name,contentLength:t.size,contentDisposition:"attachment; filename=".concat(t.name),ownerID:nd.id,contentType:t.type,privacy:1});case 6:if(i=(r=e.sent).data,o=r.error,n.target&&(n.target.value=null),!o){e.next=14;break}return ne(null!==(a=null===(l=o.data)||void 0===l?void 0:l.fields[0].error)&&void 0!==a?a:"Failed to upload a file"),e9(!1),e.abrupt("return");case 14:return e.prev=14,e.next=17,(0,e8.cT)({fileID:i.file.id,writeUrl:i.writeUrl,acl:i.acl,contentType:i.contentType,data:t,timeout:6e4,waitToken:i.waitToken,userID:null==nf?void 0:nf.id});case 17:if(!(s=e.sent)){e.next=22;break}return eN(s),e9(!1),e.abrupt("return");case 22:e.next=26;break;case 24:e.prev=24,e.t0=e.catch(14);case 26:ne("Failed to upload a file"),e9(!1);case 28:case"end":return e.stop()}},e,null,[[14,24]])})),function(e){return $.apply(this,arguments)}),[nd.id,eN,nf]),nO=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var n,t,r,i;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(na(""),et.trim()){e.next=4;break}return na("Page title is required"),e.abrupt("return");case 4:return nr(!0),n=!(0,tF.isEqual)(ev,U),t=ev.map(function(e){return{title:e.title,file_id:e.fileId,link:e.link}}),e.next=9,h.Z.updateCourse({courseId:B.id,title:et.trim(),description:ea?(ea.forEach(n4),nQ+JSON.stringify(ea)):"[]",videoLinkUrl:ef.videoLink,thumbnail:ef.videoThumbnail,lenMs:ef.videoLenMs,streamURL:ef.videoStream,transcript:es,resources:n?t:void 0,updateResources:!!n||void 0});case 9:if(!(r=e.sent.error)){e.next=15;break}return(null==r?void 0:r.status)===422&&null!=r&&null!==(i=r.data)&&void 0!==i&&null!==(i=i.fields)&&void 0!==i&&i.length?r.data.fields.forEach(function(e){"metadata.title"===e.name&&na(e.error)}):na("Failed to save page"),nr(!1),e.abrupt("return");case 15:if(!(ed!==(2===B.state))){e.next=19;break}return e.next=19,h.Z.updateCourseState({courseId:B.id,state:ed?"published":"draft"});case 19:return e.next=21,(0,J.H5)(nv);case 21:nm(p.bI,{message:"Page updated"});case 22:case"end":return e.stop()}},e)})),[U,ev,B.id,B.state,et,ea,ef,es,ed,nv,nm]),nZ=(0,u.useMemo)(function(){return[{label:"Add resource link",onClick:eZ},{label:"Add resource file",onClick:function(){var e;return null==nl||null===(e=nl.current)||void 0===e?void 0:e.click()}},{disabled:null!==es,label:"Add transcript",onClick:function(){return ec({target:{value:""}})}},{label:"Pin community post",onClick:eQ}]},[es,ec,eZ,eQ]),n_=(0,u.useMemo)(function(){var e=B.state,n=B.metadata,t=n.videoLink,r=n.videoThumbnail,i=n.videoLenMs,o=n.videoStream,a=et.trim(),l=rd(ea)?rd(eo):(0,tF.isEqual)(ea,eo);return!!no||e2||a===n.title&&(!es&&!n.transcript||es===n.transcript)&&(ed?2:1)===e&&l&&(0,tF.isEqual)(ev,U)&&(0,tF.isEqual)(ef,{videoLink:t,videoThumbnail:r,videoLenMs:i,videoStream:o})},[ea,eo,U,B,ed,ev,et,no,es,e2,ef]),nT=(0,u.useMemo)(function(){return null!=K&&K.length?(0,S.jsx)(rc,{children:(0,S.jsx)(nY.Z,{postTrees:K,group:nd,showStats:!0,draggable:!np,onDragEnd:q,onRemovePost:X})}):null},[K,nd,np,q,X]),nD=(0,u.useCallback)(function(e){e.target.value.length>50?na("Page title is ".concat(e.target.value.length,"/").concat(50)):na(""),ei(e)},[ei]),nE=(0,u.useCallback)(function(e){if(!e.target.value.trim()){na("Page title is required");return}},[]),nN=(0,u.useCallback)(function(e){if("Enter"===e.key){var n;null===(n=nc.current)||void 0===n||n.focus("start")}},[]),nL=(0,u.useCallback)(function(e,n){if("Backspace"===e.key&&1===n){var t;e.preventDefault(),null===(t=ns.current)||void 0===t||t.focus()}},[]);(0,u.useEffect)(function(){if(!n_&&!nt){var e=function(e){e.preventDefault(),e.returnValue=""},n=function n(t){if(confirm("You have unsaved changes. Do you want to leave without saving?")){window.removeEventListener("beforeunload",e),I().events.off("routeChangeStart",n),I().push(t);return}throw I().events.emit("routeChangeError",t),"Abort route change. Please ignore this error."};return window.addEventListener("beforeunload",e),I().events.on("routeChangeStart",n),function(){window.removeEventListener("beforeunload",e),I().events.off("routeChangeStart",n)}}},[n_,nt,nv]);var nA=(0,u.useMemo)(function(){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(t4,{children:(0,S.jsx)(t6,{ref:ns,value:et,variant:"borderless",placeholder:"Title",onChange:nD,onBlur:nE,onKeyDown:nN,staticLabel:!0,$hasError:!!no})}),!!(null!=ef&&ef.videoLink)&&(0,S.jsx)(tv,{course:H,module:B,editing:!0,videoDataOverride:ef,onDeleteVideoClick:eI})]})},[H,nD,nN,nE,B,eI,et,no,ef]),nR=(0,u.useMemo)(function(){return(0,S.jsxs)(ro,{children:[(0,S.jsxs)(rr,{children:[(0,S.jsx)(rl,{label:"ADD",options:nZ,placement:"bottom-start",variant:"input"}),np&&(0,S.jsx)(er.Z,{active:ed,label:ed?"Published":"Draft",onClick:ep})]}),(0,S.jsxs)(rt,{children:[!np&&(0,S.jsx)(er.Z,{active:ed,label:ed?"Published":"Draft",onClick:ep}),(0,S.jsx)(en.z,{label:"CANCEL",variant:np?"secondary":"borderless",onClick:W}),(0,S.jsx)(en.z,{label:"SAVE",onClick:nO,disabled:n_,loading:nt})]})]})},[nZ,W,nO,ep,np,ed,n_,nt]),nz=(0,u.useMemo)(function(){return(0,S.jsxs)(S.Fragment,{children:[!!(null!=ev&&ev.length)&&(0,S.jsxs)(t8,{children:[(0,S.jsx)(t7,{children:"Resources"}),ev.map(function(e,n){return(0,S.jsx)(tn,{resource:e,editing:!0,canMoveUp:n>0,canMoveDown:n<ev.length-1,onMoveUp:nw,onMoveDown:nk,onEdit:e$,onDelete:eG,onAttachmentPreview:nb},n)})]}),null!==es&&(0,S.jsxs)(re,{children:[(0,S.jsx)(t3,{children:"Transcript"}),(0,S.jsx)(ee.I,{staticLabel:!0,placeholder:"Add your transcript...",value:es,multiline:!0,onChange:ec,minRows:np?5:6,maxRows:np?5:6})]}),!!no&&(0,S.jsx)(ra,{children:no}),nR,(0,S.jsx)("input",{ref:nl,type:"file",style:{display:"none"},accept:(0,e8.Yw)(),onChange:nS}),ex&&(0,S.jsx)(tV,{open:!0,onSubmit:ng,onClose:eC}),ej&&(0,S.jsx)(eu.T,{open:!0,header:"Delete video?",confirmLabel:"Delete",confirmButtonVariant:"error",cancelButtonVariant:np?"secondary":"borderless",onConfirm:nC,onCancel:eM,onClose:eM,children:"Are you sure you want to delete this video? You can't undo this."}),eO&&(0,S.jsx)(tG,{open:!0,resource:eB,onSubmit:nI,onClose:e_}),eE&&(0,S.jsx)(tX,{open:!0,file:eA,error:e7,uploading:e5,onSubmit:nj,onClose:eL}),eF&&(0,S.jsx)(t0,{open:!0,resource:eB,onSubmit:nM,onClose:eH}),eW&&(0,S.jsx)(eu.T,{open:!0,header:"Delete file?",confirmLabel:"Remove",confirmButtonVariant:"error",cancelButtonVariant:np?"secondary":"borderless",onConfirm:nP,onCancel:eq,onClose:eq,children:'Are you sure you want to delete the file "'.concat(eJ.title,"\"? You can't undo this.")}),eK&&(0,S.jsx)(eu.T,{open:!0,header:"Pin community post",confirmLabel:"Got it",onClose:e0,onConfirm:e0,children:"To pin a post to this page, go to the post you want to pin and in the “...” context menu, select “Pin to course page”, and type in the name of this page."}),!np&&nT]})},[eL,e_,eC,eM,e0,eq,eH,nR,nj,nI,ng,nb,nP,nC,nM,nk,nw,ec,nS,eE,eO,ex,ej,np,eK,eW,eF,no,nT,eA,e7,e5,eJ,eB,ev,eG,e$,es]),nF=(0,u.useMemo)(function(){return(0,S.jsx)(en.z,{icon:"FileVideo",disabled:!!(null!=ef&&ef.videoLink),iconSize:20,onClick:ey,variant:np?"icon-borderless-no-hover":"icon-borderless",title:"Add video",disableRipple:!0})},[np,ey,null==ef?void 0:ef.videoLink]);return(0,S.jsxs)(t2,{children:[(0,S.jsx)(nJ,{ref:nc,initialContent:eo,onChange:el,onKeyDown:nL,onFileUploadStart:nx,onFileUploadEnd:ny,contentTop:nA,contentBottom:nz,extraMenuItems:nF}),np&&nT]})}),rf=(0,u.memo)(function(e){var n,t,r=e.course,i=e.module,o=e.initialLoad,l=e.startTime,s=e.setStartTime,f=e.setAttachmentPreview,m=e.editing,v=e.pinnedPosts,b=(0,u.useState)(v),g=b[0],x=b[1],C=(0,u.useRef)(!1),w=(0,d.bI)("currentGroup"),k=w.currentGroup,I=w.dispatch,M=(0,j.useRouter)();(0,u.useEffect)(function(){o&&!i&&((0,e5.Lx)({message:"Page Not Found",severity:"error"}),(0,J.VF)(M,(0,y.rE)({group:k,course:r.course,courseModule:"overview"})))},[o,r,k,M,i]),(0,u.useEffect)(function(){m&&!C.current&&(C.current=!0,(0,J.hj)(M,"e",!0))},[M,m]);var P=(0,u.useMemo)(function(){var e;return null!=i&&null!==(e=i.metadata)&&void 0!==e&&e.resources?(0,q.W4)(JSON.parse(i.metadata.resources)):[]},[i]),O=(0,u.useCallback)(function(){(0,J.VF)(M,(0,y.rE)({group:k,course:r.course,courseModule:i.id,edit:!0}))},[r,k,i,M]),Z=(0,u.useCallback)(function(){(0,J.H5)(M)},[M]),_=(0,u.useCallback)((n=(0,a.Z)(c().mark(function e(n){var t,r,o,a,l;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.source,r=n.destination,o=n.draggableId,a=t.index,!r||!(a!==(l=r.index))){e.next=14;break}return x((0,q.WR)({array:g,oldIdx:a,newIdx:l})),e.next=9,h.Z.updatePinnedModulePostPosition({courseId:i.id,postId:o,delta:l-a});case 9:if(!e.sent.error){e.next=14;break}return x(g),e.abrupt("return",I(p.bI,{message:"There was an issue with reordering.",severity:"error"}));case 14:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),[I,g,i]),T=(0,u.useCallback)((t=(0,a.Z)(c().mark(function e(n){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,h.Z.unpinPostFromModule({postID:n.id});case 4:e.sent.error||(x(g.filter(function(e){var t=e.post.id;return n.id!==t})),I(p.bI,{message:"Post removed from page"}));case 7:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),[I,g]);return i?m?(0,S.jsx)(rp,{course:r.course,module:i,resources:P,onAttachmentPreview:f,onStopEditing:Z,onPostDragEnd:_,onRemovePost:T,pinnedPosts:g}):(0,S.jsx)(tz,{course:r.course,courseChildren:r.children,module:i,resources:P,startTime:l,setStartTime:s,onStartEditing:O,onAttachmentPreview:f,onPostDragEnd:_,onRemovePost:T,pinnedPosts:g}):null});function rm(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function rv(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function rh(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?rv(Object(t),!0).forEach(function(n){(0,l.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):rv(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function rb(e){var n,t,r=e.course,i=e.selectedModule,o=e.pinnedPosts,s=e.editing,m=(0,d.bI)("isMobile"),v=m.isMobile,g=m.dispatch,x=(0,u.useState)(r),y=x[0],C=x[1],w=(0,u.useState)(null),k=w[0],j=w[1],I=(0,u.useState)(!1),M=I[0],P=I[1],O=(0,u.useState)(null),Z=O[0],_=O[1],T=(0,u.useState)(null),D=T[0],E=T[1],N=(0,u.useRef)();(0,u.useEffect)(function(){for(var e=null,n=null,t=y.children,r=void 0===t?[]:t,o=0;o<r.length;o++)if(!e||!n){var a=r[o],l=a.course,s=a.children,c=void 0===s?[]:s;if(e&&!n&&"module"===l.unitType&&2===l.state&&(n=l),l.id===i)e||(e=l);else for(var u=0;u<c.length;u++){var d=c[u].course;e&&!n&&2===c[u].course.state&&(n=c[u].course),d.id!==i||e||(e=d)}}j(e),P(!0)},[y,i]),(0,u.useEffect)(function(){var e,n=(0,f.tv)({key:f.H0.courseMenu}).value,t=null==y||null===(e=y.course)||void 0===e?void 0:e.id,r=(void 0===n?{}:n)[["scroll-top-".concat(t)]];r&&setTimeout(function(){N.current.scrollTop=r},0)},[y]);var L=(0,u.useCallback)(function(){var e,n=(0,f.tv)({key:f.H0.courseMenu}).value,t=null==y||null===(e=y.course)||void 0===e?void 0:e.id;(0,f.co)({key:f.H0.courseMenu,value:rh(rh({},void 0===n?{}:n),{},(0,l.Z)({},"scroll-top-".concat(t),N.current.scrollTop))})},[y]);(0,u.useEffect)(function(){var e={};y.children&&(y.children.forEach(function(n){if("module"===n.course.unitType&&2===n.course.state){var t;e[n.course.id]=null!==(t=n.course.metadata)&&void 0!==t&&!!t.completed}n.children&&n.children.forEach(function(n){var t;e[n.course.id]=null!==(t=n.course.metadata)&&void 0!==t&&!!t.completed})}),g(p.Io,e))},[y,g]);var A=(0,u.useCallback)(function(e){C(rh(rh({},y),e))},[y]),R=(0,u.useCallback)((0,a.Z)(c().mark(function e(){var n,t;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.getCourse({courseId:y.course.id});case 2:if(t=(n=e.sent).data,!n.error){e.next=8;break}return g(p.bI,{message:"Something went wrong, please try again",severity:"error"}),e.abrupt("return");case 8:C(t);case 9:case"end":return e.stop()}},e)})),[null==y||null===(t=y.course)||void 0===t?void 0:t.id,g]),z=(0,u.useCallback)((n=(0,a.Z)(c().mark(function e(n){var t,r,i;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=null!==(t=null==n||null===(r=n.fileResources)||void 0===r?void 0:r.map(function(e){return{id:null==e?void 0:e.fileId,metadata:{contentType:null==e?void 0:e.fileContentType,fileName:null==e?void 0:e.fileName,title:null==e?void 0:e.title}}}))&&void 0!==t?t:[],E(rh(rh({},n),{},{fileResources:i}));case 2:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),[]),F=(0,u.useMemo)(function(){return(0,S.jsx)(e0,{ref:N,children:(0,S.jsx)(eY,{course:y,saveScroll:L,selectedModule:i,onCourseUpdated:A,refetchCourses:R})})},[y,L,i,A,R]),$=U;return v&&($=eY),"overview"===i?$=U:i&&($=rf),"menu"===i&&($=eY),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(eQ,{children:[!v&&F,(0,S.jsx)(e2,{children:(0,S.jsx)(e4,{$editing:s,children:(0,S.jsx)($,{course:y,module:k,startTime:Z,initialLoad:M,setStartTime:_,setAttachmentPreview:z,onCourseUpdated:A,refetchCourses:R,editing:s,pinnedPosts:o})})})]}),!!D&&(0,S.jsx)(b.Z,{previewAttachments:D.fileResources,initialIdx:D.initialIdx,onClose:function(){return E(!1)}})]})}rb.getRenderData=(r=(0,a.Z)(c().mark(function e(n){var t,r,i,o,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.ctx,r=n.apiClient,i=(0,y.XI)(t.query)||"",o=(0,y.Z9)(t.query),a=(0,y.ju)(t.query),e.next=6,r.readCourseData({courseName:i,selectedModuleID:a,groupName:o});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),rb.initPage=(i=(0,a.Z)(c().mark(function e(n){var t,r,i,o,a,l,s,u,d,p,f,v,h,b,g,x,C,w,k,j,I,M,P,S,O,Z,_,T,D,E,N,L,A,R,z,F,$,H;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h=n.props,b=n.ctx,g=h.renderData,x=h.currentGroup,C=(0,y.ju)(b.query)||"",w=(0,y.XI)(b.query)||"",k=(0,y.Z9)(b.query)||"",j="1"===(0,y.ys)(b.query),!((I=null==g||null===(t=g.course)||void 0===t||null===(t=t.course)||void 0===t||null===(t=t.metadata)||void 0===t?void 0:t.lastModule)&&"overview"!==C&&"menu"!==C)){e.next=10;break}return M=(0,y.rE)({group:{name:k},course:g.course.course,courseModule:I}).as,e.abrupt("return",{settings:{redirect:{destination:M,permanent:!1}}});case 10:if(C){e.next=36;break}Z=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return rm(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return rm(e,n)}}(e))){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(l)throw o}}}}(null!==(P=null==g||null===(S=g.course)||void 0===S?void 0:S.children)&&void 0!==P?P:[]),e.prev=13,Z.s();case 15:if((_=Z.n()).done){e.next=25;break}if(D=(T=_.value).course,E=T.children,"module"!==D.unitType){e.next=20;break}return O=D.id,e.abrupt("break",25);case 20:if(!(null!=E&&E.length)){e.next=23;break}return O=E[0].course.id,e.abrupt("break",25);case 23:e.next=15;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(13),Z.e(e.t0);case 30:return e.prev=30,Z.f(),e.finish(30);case 33:if(!O){e.next=36;break}return N=(0,y.rE)({group:{name:k},course:g.course.course,courseModule:O}).as,e.abrupt("return",{settings:{redirect:{destination:N,permanent:!1}}});case 36:if(!(w!==(null==g||null===(r=g.course)||void 0===r||null===(r=r.course)||void 0===r?void 0:r.name))){e.next=39;break}return L=(0,y.rE)({group:{name:k},course:g.course.course,courseModule:w}).as,e.abrupt("return",{settings:{redirect:{destination:L,permanent:!1}}});case 39:if(R=(A=function e(n,t){var r;if(!n)return null;if((null===(r=n.course)||void 0===r?void 0:r.id)===t)return n;if(n.children)for(var i=0;i<n.children.length;i++){var o=e(n.children[i],t);if(o)return o}return null}(null==g?void 0:g.course,C))?"".concat((null===(i=A.course)||void 0===i||null===(i=i.metadata)||void 0===i?void 0:i.title)||""," - ")+"".concat((null==g||null===(o=g.course)||void 0===o||null===(o=o.course)||void 0===o||null===(o=o.metadata)||void 0===o?void 0:o.title)||""," ")+"\xb7 ".concat(null==x||null===(a=x.metadata)||void 0===a?void 0:a.displayName):"".concat((null==g||null===(l=g.course)||void 0===l||null===(l=l.course)||void 0===l||null===(l=l.metadata)||void 0===l?void 0:l.title)||""," ")+"\xb7 ".concat(null==x||null===(s=x.metadata)||void 0===s?void 0:s.displayName),z=(null==A||null===(u=A.course)||void 0===u||null===(u=u.metadata)||void 0===u?void 0:u.desc)||(null==g||null===(d=g.course)||void 0===d||null===(d=d.course)||void 0===d||null===(d=d.metadata)||void 0===d?void 0:d.desc)||""){var c;z=(c=n3(z))?c.map(n2).filter(function(e){return!!e}).join(" "):""}return(F=null==A||null===(p=A.course)||void 0===p||null===(p=p.metadata)||void 0===p?void 0:p.videoThumbnail)||null==A||null===(f=A.course)||void 0===f||null===(f=f.metadata)||void 0===f||!f.desc||(F=null===($=function e(n){if(!n)return null;var t,r=nX(n);try{for(r.s();!(t=r.n()).done;){var i,o,a=t.value;if("image"===a.type&&null!==(i=a.attrs)&&void 0!==i&&i.src)return a;if(null!==(o=a.content)&&void 0!==o&&o.length){var l=e(a.content);if(l)return l}}}catch(e){r.e(e)}finally{r.f()}return null}(n3(A.course.metadata.desc)))||void 0===$||null===($=$.attrs)||void 0===$?void 0:$.src),F||(F=(null==g||null===(H=g.course)||void 0===H||null===(H=H.course)||void 0===H||null===(H=H.metadata)||void 0===H?void 0:H.coverImage)||""),e.abrupt("return",rh({settings:{mainMenuItem:m.t5.GroupDefaultClassroom,mainMenuName:m.K0.GroupDefault,pageTitle:R,pageMeta:{description:z.slice(0,160)||"",image:F}},selectedModule:C,course:g.course,pinnedPosts:null!==(v=null==g?void 0:g.pinnedPosts)&&void 0!==v?v:[],editing:j},h));case 47:case"end":return e.stop()}},e,null,[[13,27,30,33]])})),function(e){return i.apply(this,arguments)});var rg=(0,v.Z)(rb),rx=!0,ry=(0,o.Z)(rg)},49452:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[group]/classroom/[course]",function(){return t(47722)}])}},function(e){e.O(0,[4027,630,6911,6124,1613,6318,2065,8271,1004,2749,2888,9774,179],function(){return e(e.s=49452)}),_N_E=e.O()}]);